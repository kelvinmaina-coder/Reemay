<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIEGE - Kenyan Integrated Electoral & Governance Ecosystem</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

       <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap');
        
        :root {
            --primary-color: #008751;
            --secondary-color: #b00020;
            --accent-color: #ffa500;
            --hacker-green: #00ff00;
            --matrix-green: #00cc00;
            --dark-terminal: #0a0a0a;
            --cyber-blue: #0066ff;
            --warning-orange: #ff6600;
            --error-red: #ff3333;
            --admin-red: #dc2626;
            --official-blue: #2563eb;
            --voter-green: #16a34a;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #e0e0e0;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        .terminal-font {
            font-family: 'JetBrains Mono', monospace;
        }

        .cyber-grid {
            background-image: 
                linear-gradient(rgba(0, 255, 0, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 0, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        .hacker-text {
            color: var(--hacker-green);
            text-shadow: 0 0 10px var(--hacker-green);
        }

        .cyber-card {
            background: rgba(10, 10, 10, 0.8);
            border: 1px solid var(--matrix-green);
            border-radius: 8px;
            backdrop-filter: blur(10px);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.1);
        }

        .voting-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            color: #333;
        }

        .dark .voting-card {
            background: rgba(45, 45, 45, 0.95);
            color: #e0e0e0;
        }

        .cyber-input {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid var(--matrix-green);
            color: var(--hacker-green);
            font-family: 'JetBrains Mono', monospace;
            border-radius: 4px;
            padding: 10px;
        }

        .voting-input {
            background: white;
            border: 1px solid #ddd;
            color: #333;
            border-radius: 4px;
            padding: 10px;
        }

        .dark .voting-input {
            background: #333;
            border-color: #555;
            color: #e0e0e0;
        }

        .cyber-button {
            background: linear-gradient(45deg, #00cc00, #009900);
            border: none;
            color: black;
            font-weight: bold;
            border-radius: 4px;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .voting-button {
            background: var(--primary-color);
            border: none;
            color: white;
            font-weight: bold;
            border-radius: 4px;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-button {
            background: var(--admin-red);
            border: none;
            color: white;
            font-weight: bold;
            border-radius: 4px;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .official-button {
            background: var(--official-blue);
            border: none;
            color: white;
            font-weight: bold;
            border-radius: 4px;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .voter-button {
            background: var(--voter-green);
            border: none;
            color: white;
            font-weight: bold;
            border-radius: 4px;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .voting-button:hover {
            background: #007045;
        }

        .cyber-button:hover {
            background: linear-gradient(45deg, #00ff00, #00cc00);
            box-shadow: 0 0 15px var(--hacker-green);
        }

        .cyber-button-danger {
            background: linear-gradient(45deg, #ff3333, #cc0000);
        }

        .cyber-button-danger:hover {
            background: linear-gradient(45deg, #ff6666, #ff3333);
            box-shadow: 0 0 15px var(--error-red);
        }

        .terminal-output {
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid var(--matrix-green);
            border-radius: 4px;
            padding: 15px;
            height: 400px;
            overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            color: var(--hacker-green);
        }

        .terminal-line {
            margin-bottom: 5px;
            line-height: 1.4;
        }

        .terminal-prompt {
            color: var(--cyber-blue);
        }

        .kenya-flag-colors {
            background: linear-gradient(to right, #000000 25%, #ff0000 25% 50%, #008000 50% 75%, #ffffff 75%);
            height: 4px;
            width: 100%;
        }

        .matrix-rain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            opacity: 0.1;
        }

        .hacker-modal {
            background: rgba(10, 10, 10, 0.95);
            border: 2px solid var(--matrix-green);
            border-radius: 8px;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.3);
        }

        .voting-modal {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .dark .voting-modal {
            background: rgba(45, 45, 45, 0.95);
        }

        .tab-active {
            background: var(--matrix-green);
            color: black;
            font-weight: bold;
        }

        .loading-bar {
            height: 4px;
            background: linear-gradient(90deg, var(--matrix-green), var(--hacker-green));
            width: 0%;
            transition: width 0.3s ease;
        }

        .network-node {
            width: 80px;
            height: 80px;
            border: 2px solid var(--matrix-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 255, 0, 0.1);
            position: absolute;
            transition: all 0.3s ease;
        }

        .network-node:hover {
            background: rgba(0, 255, 0, 0.3);
            box-shadow: 0 0 20px var(--matrix-green);
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }

        .sidebar {
            background-color: rgba(10, 10, 10, 0.9);
            border-right: 1px solid var(--matrix-green);
        }

        .sidebar-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s;
            color: #4b5563;
        }

        .sidebar-link:hover {
            background-color: rgba(0, 255, 0, 0.1);
            color: var(--hacker-green);
        }

        .sidebar-link.active {
            background-color: var(--matrix-green);
            color: black;
        }

        .candidate-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease;
        }

        .custom-radio input[type="radio"] {
            display: none;
        }

        .custom-radio input[type="radio"] + label {
            position: relative;
            padding-left: 30px;
            cursor: pointer;
            display: inline-block;
            line-height: 20px;
        }

        .custom-radio input[type="radio"] + label:before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 20px;
            height: 20px;
            border: 2px solid #ddd;
            border-radius: 50%;
            background: #fff;
        }

        .custom-radio input[type="radio"]:checked + label:before {
            border-color: var(--primary-color);
        }

        .custom-radio input[type="radio"]:checked + label:after {
            content: '';
            position: absolute;
            left: 5px;
            top: 5px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--primary-color);
        }

        .role-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .role-admin {
            background-color: var(--admin-red);
            color: white;
        }

        .role-official {
            background-color: var(--official-blue);
            color: white;
        }

        .role-voter {
            background-color: var(--voter-green);
            color: white;
        }

        .photo-preview {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px dashed #ddd;
        }

        .whatsapp-chat {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            background: #f9f9f9;
        }

        .dark .whatsapp-chat {
            background: #2d2d2d;
            border-color: #555;
        }

        .message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 18px;
            max-width: 80%;
        }

        .message.user {
            background: #dcf8c6;
            margin-left: auto;
            text-align: right;
        }

        .dark .message.user {
            background: #005c4b;
            color: white;
        }

        .message.bot {
            background: #ffffff;
            border: 1px solid #e0e0e0;
        }

        .dark .message.bot {
            background: #2d2d2d;
            border-color: #444;
        }

        .progress-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
            position: relative;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }

        .step-active .step-number {
            background: var(--primary-color);
            color: white;
        }

        .step-completed .step-number {
            background: var(--voter-green);
            color: white;
        }

        .step-label {
            font-size: 0.75rem;
            text-align: center;
            color: #6b7280;
        }

        .step-active .step-label {
            color: var(--primary-color);
            font-weight: 600;
        }

        .progress-line {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: #e5e7eb;
            z-index: 1;
        }

        .progress-fill {
            position: absolute;
            top: 20px;
            left: 0;
            height: 2px;
            background: var(--primary-color);
            z-index: 1;
            transition: width 0.5s ease;
        }

        .position-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border-radius: 0.5rem;
            background: white;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }

        .dark .position-section {
            background: #2d2d2d;
        }

        .position-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary-color);
            display: flex;
            align-items: center;
        }

        .position-title i {
            margin-right: 0.5rem;
        }

        .candidates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
        }

        .candidate-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .candidate-item:hover {
            border-color: var(--primary-color);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .candidate-item.selected {
            border-color: var(--primary-color);
            background-color: rgba(0, 135, 81, 0.05);
        }

        .candidate-photo {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 1rem;
            border: 2px solid #e5e7eb;
        }

        .candidate-info {
            flex: 1;
        }

        .candidate-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .candidate-party {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 0.25rem;
        }

        .candidate-position {
            font-size: 0.75rem;
            color: #9ca3af;
        }

        .vote-summary {
            background: white;
            border-radius: 0.5rem;
            padding: 1.5rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .dark .vote-summary {
            background: #2d2d2d;
        }

        .summary-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .dark .summary-item {
            border-bottom-color: #444;
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-position {
            font-weight: 500;
        }

        .summary-candidate {
            color: #6b7280;
        }

        .empty-selection {
            color: #9ca3af;
            font-style: italic;
        }

        .ballot-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
        }

        .navigation-button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .nav-prev {
            background: #f3f4f6;
            color: #374151;
        }

        .nav-next {
            background: var(--primary-color);
            color: white;
        }

        .nav-prev:hover {
            background: #e5e7eb;
        }

        .nav-next:hover {
            background: #007045;
        }

        .nav-prev:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .nav-next:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0;
            z-index: 1000;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(1000px) rotate(360deg);
                opacity: 0;
            }
        }

        .ddos-protection {
            background: linear-gradient(45deg, #ff3333, #cc0000);
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }
        
        .security-alert {
            animation: alert-pulse 2s infinite;
            border: 2px solid #ff3333;
        }
        
        @keyframes alert-pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 51, 51, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 51, 51, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 51, 51, 0); }
        }
        
        .blockchain-verified {
            background: linear-gradient(45deg, #00cc00, #009900);
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }
        
        .pen-test-results {
            max-height: 300px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
        }
        
        .pen-test-item {
            padding: 8px;
            border-bottom: 1px solid #333;
        }
        
        .pen-test-item.critical {
            color: #ff3333;
            font-weight: bold;
        }
        
        .pen-test-item.warning {
            color: #ff9900;
        }
        
        .pen-test-item.info {
            color: #00cc00;
        }
        
        .network-monitor {
            height: 300px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 5px;
            position: relative;
            overflow: hidden;
        }
        
        .network-connection {
            position: absolute;
            height: 2px;
            background: var(--matrix-green);
            transform-origin: 0 0;
        }
        
        .chatbot-container {
            height: 500px;
            display: flex;
            flex-direction: column;
        }
        
        .chatbot-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            background-color: white;
        }
        
        .dark .chatbot-messages {
            background-color: #2d2d2d;
            border-color: #555;
        }
        
        .chatbot-input-container {
            display: flex;
        }
        
        .chatbot-input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem 0 0 0.375rem;
        }
        
        .dark .chatbot-input {
            background-color: #2d2d2d;
            border-color: #555;
            color: white;
        }
        
        .chatbot-send {
            padding: 0.75rem 1rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 0 0.375rem 0.375rem 0;
            cursor: pointer;
        }
        
        .success-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            max-width: 500px;
            width: 90%;
        }
        
        .dark .success-popup {
            background: #2d2d2d;
            color: white;
        }
        
        .success-popup h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }
        
        .success-popup p {
            margin-bottom: 1.5rem;
        }
        
        .success-popup .flowers {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .dark-mode-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            background: var(--matrix-green);
            color: black;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        /* Responsive improvements */
        @media (max-width: 768px) {
            .container {
                padding: 0 10px;
            }
            
            .sidebar {
                width: 100%;
                margin-bottom: 20px;
            }
            
            .flex {
                flex-direction: column;
            }
            
            .candidates-grid {
                grid-template-columns: 1fr;
            }
            
            .cyber-card {
                padding: 15px;
            }
            
            .terminal-output {
                height: 300px;
            }
        }
    </style>
   
</head>
<body class="cyber-grid">
    <!-- Matrix Rain Background -->
    <canvas id="matrixRain" class="matrix-rain"></canvas>

    <!-- Main Container -->
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-8">
            <div class="kenya-flag-colors"></div>
            <div class="container mx-auto px-4 py-3 flex justify-between items-center">
                <div class="flex items-center space-x-2">
                    <img src="https://cdn.pixabay.com/photo/2013/07/13/14/16/kenya-162332_960_720.png" alt="Kenya Flag" class="h-8">
                    <h1 class="text-xl font-bold text-green-400 terminal-font">KIEGE - Kenyan Integrated Electoral & Governance Ecosystem</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="language-selector">
                        <select id="language-selector" class="cyber-input">
                            <option value="en" selected>English</option>
                            <option value="sw">Kiswahili</option>
                        </select>
                    </div>
                    <button id="system-mode-toggle" class="cyber-button px-3 py-1 text-sm">
                        <i class="fas fa-exchange-alt mr-1"></i> Switch Mode
                    </button>
                    <button id="logout-btn-header" class="cyber-button-danger px-3 py-1 text-sm hidden">
                        <i class="fas fa-sign-out-alt mr-1"></i> Logout
                    </button>
                </div>
            </div>
            
            <!-- Security Status Bar -->
            <div class="cyber-card p-4 mb-4">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center">
                            <div class="w-3 h-3 bg-green-500 rounded-full mr-2 pulse"></div>
                            <span class="text-green-400 terminal-font">VOTING SYSTEM: ACTIVE</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                            <span class="text-blue-400 terminal-font">SECURITY: MAXIMUM</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-3 h-3 bg-purple-500 rounded-full mr-2"></div>
                            <span class="text-purple-400 terminal-font">BLOCKCHAIN: VERIFIED</span>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-green-400 terminal-font" id="currentTime"></div>
                        <div class="text-gray-400 text-sm terminal-font">AUTHORIZED PERSONNEL ONLY</div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Dashboard -->
        <div class="flex">
            <!-- Sidebar Navigation -->
            <aside class="sidebar w-64 p-4 rounded-lg mr-6">
                <nav class="space-y-2">
                    <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-4">SYSTEM MODES</h3>
                    <a href="#" class="sidebar-link" data-mode="voting">
                        <i class="fas fa-vote-yea mr-3"></i> Voting Portal
                    </a>
                    <a href="#" class="sidebar-link" data-mode="security">
                        <i class="fas fa-shield-alt mr-3"></i> Security Command
                    </a>
                    <a href="#" class="sidebar-link" data-mode="admin">
                        <i class="fas fa-cogs mr-3"></i> Admin Dashboard
                    </a>
                    <a href="#" class="sidebar-link" data-mode="official">
                        <i class="fas fa-user-tie mr-3"></i> IEBC Official
                    </a>
                    <a href="#" class="sidebar-link" data-mode="whatsapp">
                        <i class="fab fa-whatsapp mr-3"></i> WhatsApp Support
                    </a>
                    <a href="#" class="sidebar-link" data-mode="chatbot">
                        <i class="fas fa-robot mr-3"></i> Chatbot Assistant
                    </a>
                    
                    <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mt-6 mb-4">SECURITY TOOLS</h3>
                    <a href="#" class="sidebar-link" data-action="security-scan">
                        <i class="fas fa-search mr-3"></i> Security Audit
                    </a>
                    <a href="#" class="sidebar-link" data-action="pen-test">
                        <i class="fas fa-crosshairs mr-3"></i> Penetration Test
                    </a>
                    <a href="#" class="sidebar-link" data-action="blockchain-check">
                        <i class="fas fa-link mr-3"></i> Blockchain Verify
                    </a>
                    <a href="#" class="sidebar-link" data-action="network-monitor">
                        <i class="fas fa-network-wired mr-3"></i> Network Monitor
                    </a>
                    <a href="#" class="sidebar-link" data-action="ddos-protection">
                        <i class="fas fa-shield-virus mr-3"></i> DDoS Protection
                    </a>
                    <a href="#" class="sidebar-link" data-action="threat-analysis">
                        <i class="fas fa-chart-line mr-3"></i> Threat Analysis
                    </a>
                </nav>
            </aside>
            
            <!-- Main Content Area -->
            <div class="flex-grow">
                <!-- Voting Portal View -->
                <div id="voting-mode" class="mode-view">
                    <!-- Voter Registration Screen -->
                    <div id="voter-registration-screen" class="voting-card p-6 max-w-md mx-auto">
                        <h2 class="text-2xl font-bold text-center mb-6">Voter Registration</h2>
                        <form id="voter-registration-form" class="space-y-6">
                            <div>
                                <label for="full-name" class="block text-sm font-medium">Full Name</label>
                                <input type="text" id="full-name" class="voting-input mt-1 block w-full" placeholder="Enter your full name" required>
                            </div>
                            <div>
                                <label for="national-id" class="block text-sm font-medium">National ID Number</label>
                                <input type="text" id="national-id" class="voting-input mt-1 block w-full" placeholder="Enter your ID number" required>
                            </div>
                            <div>
                                <label for="phone-number" class="block text-sm font-medium">Phone Number</label>
                                <div class="mt-1 flex rounded-md shadow-sm">
                                    <span class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm"> +254 </span>
                                    <input type="text" id="phone-number" class="voting-input flex-1 min-w-0 block w-full rounded-none rounded-r-md" placeholder="7XX XXX XXX" required>
                                </div>
                            </div>
                            <div>
                                <label for="county" class="block text-sm font-medium">County</label>
                                <select id="county" class="voting-input mt-1 block w-full" required>
                                    <option value="">Select County</option>
                                    <!-- Counties will be populated by JavaScript -->
                                </select>
                            </div>
                            <div>
                                <label for="constituency" class="block text-sm font-medium">Constituency</label>
                                <select id="constituency" class="voting-input mt-1 block w-full" required>
                                    <option value="">Select Constituency</option>
                                    <!-- Constituencies will be populated by JavaScript -->
                                </select>
                            </div>
                            <div>
                                <label for="ward" class="block text-sm font-medium">Ward</label>
                                <select id="ward" class="voting-input mt-1 block w-full" required>
                                    <option value="">Select Ward</option>
                                    <!-- Wards will be populated by JavaScript -->
                                </select>
                            </div>
                            <div>
                                <button type="submit" class="w-full voting-button py-2 px-4 rounded-md shadow-sm text-sm font-medium"> Register & Continue to Vote </button>
                            </div>
                        </form>
                        <div class="mt-6 text-center">
                            <p class="text-sm">Already registered?</p>
                            <button id="show-voter-login" class="mt-2 text-sm text-green-600 hover:text-green-500 font-medium"> Login to Vote </button>
                        </div>
                    </div>

                    <!-- Voter Login Screen -->
                    <div id="voting-login-screen" class="voting-card p-6 max-w-md mx-auto hidden">
                        <h2 class="text-2xl font-bold text-center mb-6">Voter Login</h2>
                        <form id="voting-login-form" class="space-y-6">
                            <div>
                                <label for="login-national-id" class="block text-sm font-medium">National ID Number</label>
                                <input type="text" id="login-national-id" class="voting-input mt-1 block w-full" placeholder="Enter your ID number" required>
                            </div>
                            <div>
                                <button type="submit" class="w-full voting-button py-2 px-4 rounded-md shadow-sm text-sm font-medium"> Login to Vote </button>
                            </div>
                        </form>
                        <div class="mt-6 text-center">
                            <p class="text-sm">Not registered yet?</p>
                            <button id="show-voter-registration" class="mt-2 text-sm text-green-600 hover:text-green-500 font-medium"> Register to Vote </button>
                        </div>
                    </div>

                    <!-- Voting Dashboard -->
                    <div id="voting-dashboard" class="hidden">
                        <!-- Progress Indicator -->
                        <div class="progress-indicator">
                            <div class="progress-line"></div>
                            <div class="progress-fill" id="progressFill"></div>
                            <div class="progress-step step-active" data-step="1">
                                <div class="step-number">1</div>
                                <div class="step-label">Login</div>
                            </div>
                            <div class="progress-step" data-step="2">
                                <div class="step-number">2</div>
                                <div class="step-label">Vote</div>
                            </div>
                            <div class="progress-step" data-step="3">
                                <div class="step-number">3</div>
                                <div class="step-label">Review</div>
                            </div>
                            <div class="progress-step" data-step="4">
                                <div class="step-number">4</div>
                                <div class="step-label">Confirm</div>
                            </div>
                        </div>

                        <!-- Vote Summary -->
                        <div class="vote-summary">
                            <div class="summary-title">Your Vote Summary</div>
                            <div class="summary-item">
                                <div class="summary-position">President & Deputy</div>
                                <div class="summary-candidate empty-selection">Not selected</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-position">Governor & Deputy</div>
                                <div class="summary-candidate empty-selection">Not selected</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-position">Senator</div>
                                <div class="summary-candidate empty-selection">Not selected</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-position">Women Representative</div>
                                <div class="summary-candidate empty-selection">Not selected</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-position">Member of Parliament</div>
                                <div class="summary-candidate empty-selection">Not selected</div>
                            </div>
                            <div class="summary-item">
                                <div class="summary-position">Member of County Assembly</div>
                                <div class="summary-candidate empty-selection">Not selected</div>
                            </div>
                        </div>

                        <!-- Ballot Form -->
                        <form id="ballot-form">
                            <!-- President & Deputy Section -->
                            <div class="position-section">
                                <div class="position-title">
                                    <i class="fas fa-landmark"></i> President & Deputy President (National)
                                </div>
                                <div class="candidates-grid" id="presidential-candidates-container">
                                    <!-- Candidates will be dynamically added -->
                                </div>
                            </div>

                            <!-- Governor & Deputy Section -->
                            <div class="position-section">
                                <div class="position-title">
                                    <i class="fas fa-university"></i> Governor & Deputy Governor (County)
                                </div>
                                <div class="candidates-grid" id="governor-candidates-container">
                                    <!-- Candidates will be dynamically added -->
                                </div>
                            </div>

                            <!-- Senator Section -->
                            <div class="position-section">
                                <div class="position-title">
                                    <i class="fas fa-balance-scale"></i> Senator (County)
                                </div>
                                <div class="candidates-grid" id="senator-candidates-container">
                                    <!-- Candidates will be dynamically added -->
                                </div>
                            </div>

                            <!-- Women Representative Section -->
                            <div class="position-section">
                                <div class="position-title">
                                    <i class="fas fa-female"></i> Women Representative (County)
                                </div>
                                <div class="candidates-grid" id="women-rep-candidates-container">
                                    <!-- Candidates will be dynamically added -->
                                </div>
                            </div>

                            <!-- MP Section -->
                            <div class="position-section">
                                <div class="position-title">
                                    <i class="fas fa-user-tie"></i> Member of Parliament (Constituency)
                                </div>
                                <div class="candidates-grid" id="mp-candidates-container">
                                    <!-- Candidates will be dynamically added -->
                                </div>
                            </div>

                            <!-- MCA Section -->
                            <div class="position-section">
                                <div class="position-title">
                                    <i class="fas fa-users"></i> Member of County Assembly (Ward)
                                </div>
                                <div class="candidates-grid" id="mca-candidates-container">
                                    <!-- Candidates will be dynamically added -->
                                </div>
                            </div>

                            <!-- Navigation Buttons -->
                            <div class="ballot-nav">
                                <button type="button" class="navigation-button nav-prev" id="prev-step-btn" disabled>
                                    <i class="fas fa-arrow-left mr-2"></i> Previous
                                </button>
                                <button type="button" class="navigation-button nav-next" id="next-step-btn">
                                    Next <i class="fas fa-arrow-right ml-2"></i>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Security Command Center View -->
                <div id="security-mode" class="mode-view hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                        <!-- Voting Security Panel -->
                        <div class="cyber-card p-6 lg:col-span-2">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-2xl font-bold hacker-text terminal-font">
                                    <i class="fas fa-vote-yea mr-2"></i>VOTING SECURITY DASHBOARD
                                </h2>
                                <div class="flex space-x-2">
                                    <span class="px-3 py-1 bg-green-900 text-green-400 rounded-full text-sm terminal-font">LIVE MONITORING</span>
                                </div>
                            </div>

                            <!-- Voting Metrics -->
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                                <div class="cyber-card p-4 text-center">
                                    <div class="text-3xl font-bold text-green-400 mb-2">98.7%</div>
                                    <div class="text-gray-400 text-sm terminal-font">SYSTEM UPTIME</div>
                                </div>
                                <div class="cyber-card p-4 text-center">
                                    <div class="text-3xl font-bold text-blue-400 mb-2">256-bit</div>
                                    <div class="text-gray-400 text-sm terminal-font">ENCRYPTION LEVEL</div>
                                </div>
                                <div class="cyber-card p-4 text-center">
                                    <div class="text-3xl font-bold text-yellow-400 mb-2">47</div>
                                    <div class="text-gray-400 text-sm terminal-font">ACTIVE NODES</div>
                                </div>
                                <div class="cyber-card p-4 text-center">
                                    <div class="text-3xl font-bold text-red-400 mb-2">0</div>
                                    <div class="text-gray-400 text-sm terminal-font">SECURITY INCIDENTS</div>
                                </div>
                            </div>

                            <!-- Voting Security Controls -->
                            <div class="space-y-4">
                                <div class="flex space-x-4">
                                    <button class="cyber-button flex-1" onclick="startVotingSecurityScan()">
                                        <i class="fas fa-shield-alt mr-2"></i>RUN SECURITY AUDIT
                                    </button>
                                    <button class="cyber-button flex-1" onclick="testBlockchainIntegrity()">
                                        <i class="fas fa-link mr-2"></i>TEST BLOCKCHAIN
                                    </button>
                                </div>
                                <div class="flex space-x-4">
                                    <button class="cyber-button flex-1" onclick="simulateVotingAttack()">
                                        <i class="fas fa-bug mr-2"></i>PENETRATION TEST
                                    </button>
                                    <button class="cyber-button flex-1" onclick="generateSecurityReport()">
                                        <i class="fas fa-file-alt mr-2"></i>GENERATE REPORT
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Penetration Testing Panel -->
                        <div class="cyber-card p-6">
                            <h2 class="text-2xl font-bold hacker-text terminal-font mb-6">
                                <i class="fas fa-crosshairs mr-2"></i>PENETRATION TESTING SUITE
                            </h2>

                            <!-- Target Input -->
                            <div class="mb-4">
                                <label class="block text-green-400 mb-2 terminal-font">TARGET SYSTEM</label>
                                <input type="text" id="targetInput" class="cyber-input w-full" placeholder="https://voting.iebc.or.ke" value="https://test.iebc.or.ke">
                            </div>

                            <!-- Test Options -->
                            <div class="space-y-3 mb-4">
                                <div>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" class="cyber-input" checked>
                                        <span class="ml-2 text-gray-300 terminal-font">Vulnerability Scan</span>
                                    </label>
                                </div>
                                <div>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" class="cyber-input" checked>
                                        <span class="ml-2 text-gray-300 terminal-font">Load Testing</span>
                                    </label>
                                </div>
                                <div>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" class="cyber-input">
                                        <span class="ml-2 text-gray-300 terminal-font">DDoS Simulation</span>
                                    </label>
                                </div>
                                <div>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" class="cyber-input" checked>
                                        <span class="ml-2 text-gray-300 terminal-font">SQL Injection Test</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Test Controls -->
                            <div class="space-y-3">
                                <button class="cyber-button w-full" onclick="startPenTest()">
                                    <i class="fas fa-play mr-2"></i>START PENETRATION TEST
                                </button>
                                <button class="cyber-button cyber-button-danger w-full" onclick="emergencyStop()">
                                    <i class="fas fa-stop mr-2"></i>EMERGENCY STOP
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Terminal Output -->
                    <div class="cyber-card p-6 mb-8">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold hacker-text terminal-font">
                                <i class="fas fa-terminal mr-2"></i>SECURITY TERMINAL
                            </h3>
                            <div class="flex space-x-2">
                                <button class="cyber-input px-3 py-1" onclick="clearTerminal()">Clear</button>
                                <button class="cyber-input px-3 py-1" onclick="exportLogs()">Export</button>
                            </div>
                        </div>
                        <div id="terminalOutput" class="terminal-output">
                            <div class="terminal-line">
                                <span class="terminal-prompt">IEBC-CSC></span> System initialized at <span id="initTime"></span>
                            </div>
                            <div class="terminal-line">
                                <span class="terminal-prompt">IEBC-CSC></span> Security protocols: ACTIVE
                            </div>
                            <div class="terminal-line">
                                <span class="terminal-prompt">IEBC-CSC></span> Blockchain verification: ONLINE
                            </div>
                            <div class="terminal-line">
                                <span class="terminal-prompt">IEBC-CSC></span> Penetration testing suite: READY
                            </div>
                            <div class="terminal-line">
                                <span class="terminal-prompt">IEBC-CSC></span> Type 'help' for available commands
                            </div>
                        </div>
                        <div class="mt-4 flex">
                            <span class="cyber-input rounded-r-none terminal-font">IEBC-CSC></span>
                            <input type="text" id="terminalInput" class="cyber-input flex-1 rounded-l-none" placeholder="Enter command..." onkeypress="handleTerminalInput(event)">
                        </div>
                    </div>

                    <!-- Network Visualization -->
                    <div class="cyber-card p-6">
                        <h3 class="text-xl font-bold hacker-text terminal-font mb-4">
                            <i class="fas fa-network-wired mr-2"></i>NETWORK TOPOLOGY VISUALIZATION
                        </h3>
                        <div id="networkVisualization" class="network-monitor">
                            <!-- Network nodes will be dynamically generated -->
                        </div>
                    </div>

                    <!-- DDoS Protection Panel -->
                    <div class="cyber-card p-6 mt-6">
                        <h3 class="text-xl font-bold hacker-text terminal-font mb-4">
                            <i class="fas fa-shield-virus mr-2"></i>DDoS PROTECTION STATUS
                        </h3>
                        <div id="ddosStatus" class="ddos-protection">
                            DDoS Protection: ACTIVE - No attacks detected
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="cyber-card p-4 text-center">
                                <div class="text-2xl font-bold text-green-400 mb-2">0</div>
                                <div class="text-gray-400 text-sm terminal-font">CURRENT ATTACKS</div>
                            </div>
                            <div class="cyber-card p-4 text-center">
                                <div class="text-2xl font-bold text-blue-400 mb-2">12.7K</div>
                                <div class="text-gray-400 text-sm terminal-font">BLOCKED REQUESTS</div>
                            </div>
                            <div class="cyber-card p-4 text-center">
                                <div class="text-2xl font-bold text-yellow-400 mb-2">98.3%</div>
                                <div class="text-gray-400 text-sm terminal-font">SUCCESS RATE</div>
                            </div>
                        </div>
                        <button class="cyber-button w-full mt-4" onclick="simulateDDoSAttack()">
                            <i class="fas fa-bolt mr-2"></i>SIMULATE DDoS ATTACK
                        </button>
                    </div>

                    <!-- Blockchain Verification Panel -->
                    <div class="cyber-card p-6 mt-6">
                        <h3 class="text-xl font-bold hacker-text terminal-font mb-4">
                            <i class="fas fa-link mr-2"></i>BLOCKCHAIN VERIFICATION
                        </h3>
                        <div id="blockchainStatus" class="blockchain-verified">
                            Blockchain Integrity: VERIFIED - All blocks cryptographically signed
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                            <div class="cyber-card p-4 text-center">
                                <div class="text-2xl font-bold text-green-400 mb-2">1,247,892</div>
                                <div class="text-gray-400 text-sm terminal-font">TOTAL BLOCKS</div>
                            </div>
                            <div class="cyber-card p-4 text-center">
                                <div class="text-2xl font-bold text-blue-400 mb-2">47/47</div>
                                <div class="text-gray-400 text-sm terminal-font">NODES VERIFIED</div>
                            </div>
                            <div class="cyber-card p-4 text-center">
                                <div class="text-2xl font-bold text-yellow-400 mb-2">0</div>
                                <div class="text-gray-400 text-sm terminal-font">TAMPERED BLOCKS</div>
                            </div>
                        </div>
                        <button class="cyber-button w-full mt-4" onclick="verifyBlockchain()">
                            <i class="fas fa-check-circle mr-2"></i>VERIFY BLOCKCHAIN INTEGRITY
                        </button>
                    </div>
                </div>

                <!-- Admin Dashboard View -->
                <div id="admin-mode" class="mode-view hidden">
                    <!-- Admin Login Screen -->
                    <div id="admin-login-screen" class="voting-card p-6 max-w-md mx-auto">
                        <h2 class="text-2xl font-bold text-center mb-6">Admin Login</h2>
                        <form id="admin-login-form" class="space-y-6">
                            <div>
                                <label for="admin-username" class="block text-sm font-medium">Username</label>
                                <input type="text" id="admin-username" class="voting-input mt-1 block w-full" placeholder="Enter admin username" required>
                            </div>
                            <div>
                                <label for="admin-password" class="block text-sm font-medium">Password</label>
                                <input type="password" id="admin-password" class="voting-input mt-1 block w-full" placeholder="Enter admin password" required>
                            </div>
                            <div>
                                <label for="admin-code" class="block text-sm font-medium">System Unique Code</label>
                                <input type="text" id="admin-code" class="voting-input mt-1 block w-full" placeholder="Enter system code" required>
                            </div>
                            <div>
                                <button type="submit" class="w-full admin-button py-2 px-4 rounded-md shadow-sm text-sm font-medium"> Login to Admin Dashboard </button>
                            </div>
                        </form>
                    </div>

                    <!-- Admin Dashboard -->
                    <div id="admin-dashboard" class="hidden">
                        <div class="admin-tabs">
                            <div class="admin-tab active" data-tab="dashboard">Dashboard</div>
                            <div class="admin-tab" data-tab="candidates">Manage Candidates</div>
                            <div class="admin-tab" data-tab="counties">Manage Counties</div>
                            <div class="admin-tab" data-tab="results">Results</div>
                            <div class="admin-tab" data-tab="security">Security</div>
                        </div>

                        <!-- Dashboard Tab -->
                        <div id="admin-dashboard-tab" class="admin-content active">
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                                <div class="voting-card p-4">
                                    <h3 class="text-gray-500 text-sm">Total Registered Voters</h3>
                                    <p id="stat-voters" class="text-3xl font-bold mt-1">19,687,433</p>
                                </div>
                                <div class="voting-card p-4">
                                    <h3 class="text-gray-500 text-sm">Total Candidates</h3>
                                    <p id="stat-candidates" class="text-3xl font-bold mt-1">125</p>
                                </div>
                                <div class="voting-card p-4">
                                    <h3 class="text-gray-500 text-sm">System Status</h3>
                                    <p id="stat-status" class="text-2xl font-bold text-green-500 mt-1">Active</p>
                                </div>
                            </div>
                            
                            <div class="voting-card p-6">
                                <h2 class="text-xl font-bold mb-4">Real-Time Results</h2>
                                <div class="county-selector mb-4">
                                    <label for="admin-results-county" class="block text-sm font-medium mb-2">View Results for County:</label>
                                    <select id="admin-results-county" class="voting-input">
                                        <option value="all">All Counties</option>
                                        <!-- Counties will be populated by JavaScript -->
                                    </select>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <canvas id="presidentialChart" width="400" height="200"></canvas>
                                    </div>
                                    <div>
                                        <canvas id="governorChart" width="400" height="200"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Candidates Tab -->
                        <div id="admin-candidates-tab" class="admin-content">
                            <div class="voting-card p-6">
                                <h2 class="text-xl font-bold mb-4">Manage Candidates</h2>
                                <div class="candidate-form">
                                    <div class="form-group">
                                        <label for="candidate-name">Candidate Name</label>
                                        <input type="text" id="candidate-name" class="voting-input" placeholder="Enter candidate name">
                                    </div>
                                    <div class="form-group">
                                        <label for="candidate-party">Party</label>
                                        <input type="text" id="candidate-party" class="voting-input" placeholder="Enter party name">
                                    </div>
                                    <div class="form-group">
                                        <label for="candidate-position">Position</label>
                                        <select id="candidate-position" class="voting-input">
                                            <option value="president">President</option>
                                            <option value="governor">Governor</option>
                                            <option value="senator">Senator</option>
                                            <option value="women_rep">Women Representative</option>
                                            <option value="mp">Member of Parliament</option>
                                            <option value="mca">Member of County Assembly</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="candidate-county">County</label>
                                        <select id="candidate-county" class="voting-input">
                                            <option value="">Select County</option>
                                            <!-- Counties will be populated by JavaScript -->
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="candidate-constituency">Constituency</label>
                                        <select id="candidate-constituency" class="voting-input">
                                            <option value="">Select Constituency</option>
                                            <!-- Constituencies will be populated by JavaScript -->
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="candidate-ward">Ward</label>
                                        <select id="candidate-ward" class="voting-input">
                                            <option value="">Select Ward</option>
                                            <!-- Wards will be populated by JavaScript -->
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="candidate-photo">Photo</label>
                                        <input type="file" id="candidate-photo" class="voting-input" accept="image/*">
                                    </div>
                                    <button class="admin-button w-full" onclick="addCandidate()">Add Candidate</button>
                                </div>
                                <div class="candidate-list">
                                    <h3 class="text-lg font-bold mb-4">Existing Candidates</h3>
                                    <div id="candidates-list">
                                        <!-- Candidates will be dynamically added -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Counties Tab -->
                        <div id="admin-counties-tab" class="admin-content">
                            <div class="voting-card p-6">
                                <h2 class="text-xl font-bold mb-4">Manage Counties, Constituencies and Wards</h2>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div>
                                        <h3 class="text-lg font-bold mb-4">Add County</h3>
                                        <div class="form-group">
                                            <label for="new-county-name">County Name</label>
                                            <input type="text" id="new-county-name" class="voting-input" placeholder="Enter county name">
                                        </div>
                                        <button class="admin-button w-full" onclick="addCounty()">Add County</button>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-bold mb-4">Add Constituency</h3>
                                        <div class="form-group">
                                            <label for="new-constituency-name">Constituency Name</label>
                                            <input type="text" id="new-constituency-name" class="voting-input" placeholder="Enter constituency name">
                                        </div>
                                        <div class="form-group">
                                            <label for="constituency-county">County</label>
                                            <select id="constituency-county" class="voting-input">
                                                <option value="">Select County</option>
                                                <!-- Counties will be populated by JavaScript -->
                                            </select>
                                        </div>
                                        <button class="admin-button w-full" onclick="addConstituency()">Add Constituency</button>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-bold mb-4">Add Ward</h3>
                                        <div class="form-group">
                                            <label for="new-ward-name">Ward Name</label>
                                            <input type="text" id="new-ward-name" class="voting-input" placeholder="Enter ward name">
                                        </div>
                                        <div class="form-group">
                                            <label for="ward-constituency">Constituency</label>
                                            <select id="ward-constituency" class="voting-input">
                                                <option value="">Select Constituency</option>
                                                <!-- Constituencies will be populated by JavaScript -->
                                            </select>
                                        </div>
                                        <button class="admin-button w-full" onclick="addWard()">Add Ward</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Results Tab -->
                        <div id="admin-results-tab" class="admin-content">
                            <div class="voting-card p-6">
                                <h2 class="text-xl font-bold mb-4">Election Results</h2>
                                <div class="county-selector mb-4">
                                    <label for="admin-results-county-detailed" class="block text-sm font-medium mb-2">View Results for County:</label>
                                    <select id="admin-results-county-detailed" class="voting-input">
                                        <option value="all">All Counties</option>
                                        <!-- Counties will be populated by JavaScript -->
                                    </select>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <canvas id="adminPresidentialChart" width="400" height="200"></canvas>
                                    </div>
                                    <div>
                                        <canvas id="adminGovernorChart" width="400" height="200"></canvas>
                                    </div>
                                    <div>
                                        <canvas id="adminSenatorChart" width="400" height="200"></canvas>
                                    </div>
                                    <div>
                                        <canvas id="adminWomenRepChart" width="400" height="200"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Security Tab -->
                        <div id="admin-security-tab" class="admin-content">
                            <div class="voting-card p-6">
                                <h2 class="text-xl font-bold mb-4">Security Settings</h2>
                                <div class="space-y-4">
                                    <div>
                                        <h3 class="text-lg font-bold mb-2">System Access Control</h3>
                                        <div class="form-group">
                                            <label for="admin-password-change">Change Admin Password</label>
                                            <input type="password" id="admin-password-change" class="voting-input" placeholder="Enter new password">
                                        </div>
                                        <div class="form-group">
                                            <label for="admin-code-change">Change System Code</label>
                                            <input type="text" id="admin-code-change" class="voting-input" placeholder="Enter new system code">
                                        </div>
                                        <button class="admin-button" onclick="updateAdminCredentials()">Update Credentials</button>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-bold mb-2">System Logs</h3>
                                        <div class="terminal-output" style="height: 200px;">
                                            <!-- System logs will be displayed here -->
                                        </div>
                                        <button class="admin-button mt-2" onclick="downloadSystemLogs()">Download Logs</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- IEBC Official Dashboard View -->
                <div id="official-mode" class="mode-view hidden">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                        <div class="voting-card p-4">
                            <h3 class="text-gray-500 text-sm">Voters in Your Area</h3>
                            <p class="text-3xl font-bold mt-1">45,328</p>
                        </div>
                        <div class="voting-card p-4">
                            <h3 class="text-gray-500 text-sm">Pending Approvals</h3>
                            <p class="text-3xl font-bold mt-1">127</p>
                        </div>
                        <div class="voting-card p-4">
                            <h3 class="text-gray-500 text-sm">Voter Turnout</h3>
                            <p class="text-3xl font-bold mt-1">68.2%</p>
                        </div>
                    </div>
                    
                    <div class="voting-card p-6">
                        <h2 class="text-xl font-bold mb-4">Voter Approval Queue</h2>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID Number</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">County</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date Applied</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">John Kariuki</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">26781234</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Nairobi</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2025-01-15</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button class="text-green-600 hover:text-green-900 mr-3">Approve</button>
                                            <button class="text-red-600 hover:text-red-900">Reject</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- WhatsApp Support View -->
                <div id="whatsapp-mode" class="mode-view hidden">
                    <div class="voting-card p-6">
                        <h2 class="text-xl font-bold mb-4">WhatsApp Support Bot</h2>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-lg font-medium mb-3">Live Chat Simulation</h3>
                                <div class="whatsapp-chat">
                                    <div class="message bot">
                                        Hello! Welcome to IEBC WhatsApp Support. How can I help you today?
                                    </div>
                                    <div class="message user">
                                        I want to register to vote
                                    </div>
                                    <div class="message bot">
                                        To register as a voter, please visit https://kiege.iebc.or.ke/register or visit your nearest IEBC office.
                                    </div>
                                    <div class="message user">
                                        How do I check my registration status?
                                    </div>
                                    <div class="message bot">
                                        Send your ID number to check your registration status.
                                    </div>
                                </div>
                                <div class="mt-4 flex">
                                    <input type="text" class="voting-input flex-1 rounded-r-none" placeholder="Type your message...">
                                    <button class="voting-button rounded-l-none">
                                        <i class="fab fa-whatsapp"></i>
                                    </button>
                                </div>
                            </div>
                            <div>
                                <h3 class="text-lg font-medium mb-3">Bot Commands</h3>
                                <div class="space-y-3">
                                    <div class="p-3 border border-gray-200 rounded-lg">
                                        <div class="font-medium">Register</div>
                                        <div class="text-sm text-gray-500">Get registration link and information</div>
                                    </div>
                                    <div class="p-3 border border-gray-200 rounded-lg">
                                        <div class="font-medium">Check Status</div>
                                        <div class="text-sm text-gray-500">Check voter registration status by ID</div>
                                    </div>
                                    <div class="p-3 border border-gray-200 rounded-lg">
                                        <div class="font-medium">My Ward</div>
                                        <div class="text-sm text-gray-500">Get polling station details</div>
                                    </div>
                                    <div class="p-3 border border-gray-200 rounded-lg">
                                        <div class="font-medium">Results</div>
                                        <div class="text-sm text-gray-500">Link to live election results</div>
                                    </div>
                                    <div class="p-3 border border-gray-200 rounded-lg">
                                        <div class="font-medium">Help</div>
                                        <div class="text-sm text-gray-500">Talk to a support agent</div>
                                    </div>
                                </div>
                                <div class="mt-6">
                                    <h3 class="text-lg font-medium mb-3">Broadcast Message</h3>
                                    <textarea class="voting-input w-full h-24" placeholder="Enter broadcast message for all users..."></textarea>
                                    <button class="voting-button w-full mt-2">
                                        <i class="fas fa-bullhorn mr-2"></i> Send Broadcast
                                    </button>
                                </div>
                                <div class="mt-6 text-center">
                                    <a href="https://wa.me/254712345678?text=Hello%20IEBC%20Support" class="whatsapp-contact" target="_blank">
                                        <i class="fab fa-whatsapp"></i> Contact Support Directly
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chatbot Assistant View -->
                <div id="chatbot-mode" class="mode-view hidden">
                    <div class="voting-card p-6">
                        <h2 class="text-xl font-bold mb-4">Chatbot Assistant</h2>
                        <div class="chatbot-container">
                            <div class="chatbot-messages" id="chatbot-messages">
                                <div class="message bot">
                                    Hello! I'm the KIEGE Assistant. How can I help you with the voting system today?
                                </div>
                            </div>
                            <div class="chatbot-input-container">
                                <input type="text" class="chatbot-input" id="chatbot-input" placeholder="Ask me about the voting system...">
                                <button class="chatbot-send" id="chatbot-send">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Role Selection Modal -->
    <div id="roleSelectionModal" class="fixed inset-0 flex items-center justify-center hidden z-50">
        <div class="voting-modal w-full max-w-md mx-4">
            <div class="p-6">
                <h3 class="text-2xl font-bold text-center mb-6">Select Your Role</h3>
                <div class="space-y-4">
                    <div class="role-option p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-green-500 transition-colors" data-role="voter">
                        <div class="flex items-center">
                            <div class="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center mr-4">
                                <i class="fas fa-user text-green-600 text-xl"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg">Voter</h4>
                                <p class="text-gray-600 text-sm">Cast your vote in elections</p>
                            </div>
                        </div>
                    </div>
                    <div class="role-option p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition-colors" data-role="official">
                        <div class="flex items-center">
                            <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center mr-4">
                                <i class="fas fa-user-tie text-blue-600 text-xl"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg">IEBC Official</h4>
                                <p class="text-gray-600 text-sm">Voter verification and management</p>
                            </div>
                        </div>
                    </div>
                    <div class="role-option p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-red-500 transition-colors" data-role="admin">
                        <div class="flex items-center">
                            <div class="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center mr-4">
                                <i class="fas fa-user-shield text-red-600 text-xl"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-lg">Administrator</h4>
                                <p class="text-gray-600 text-sm">Full system access and control</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mt-6 text-center">
                    <button id="confirmRoleButton" class="voting-button w-full">Confirm Role</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Voting Confirmation Modal -->
    <div id="votingConfirmationModal" class="fixed inset-0 flex items-center justify-center hidden z-50">
        <div class="voting-modal w-full max-w-2xl mx-4">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold text-green-600">Voting Confirmation</h3>
                    <button onclick="closeModal('votingConfirmationModal')" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div id="votingConfirmationContent" class="space-y-4">
                    <div class="text-center">
                        <i class="fas fa-check-circle text-green-500 text-5xl mb-4"></i>
                        <h4 class="text-xl font-bold text-gray-800">Congratulations for voting!</h4>
                        <p class="text-gray-600 mt-2">Your vote has been successfully recorded and verified.</p>
                    </div>
                    <div class="border-t pt-4">
                        <h5 class="font-medium text-gray-800 mb-2">Voting Receipt</h5>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <div class="flex justify-between mb-2">
                                <span class="text-gray-600">Voter ID:</span>
                                <span class="font-medium" id="receiptVoterId">12345678</span>
                            </div>
                            <div class="flex justify-between mb-2">
                                <span class="text-gray-600">Timestamp:</span>
                                <span class="font-medium" id="receiptTimestamp">2025-01-15 14:30:45</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Transaction ID:</span>
                                <span class="font-medium" id="receiptTransactionId">TX-7A83B92C-IEBC</span>
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-center space-x-4 mt-6">
                        <button class="voting-button" onclick="downloadVotingReceipt()">
                            <i class="fas fa-download mr-2"></i> Download Receipt
                        </button>
                        <button class="voting-button" onclick="closeModal('votingConfirmationModal')">
                            <i class="fas fa-check mr-2"></i> Done
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Popup with Flowers -->
    <div id="successPopup" class="success-popup hidden">
        <div class="flowers">
            
        </div>
        <h3>Congratulations!</h3>
        <p>You have successfully cast your vote. Thank you for participating in the democratic process.</p>
        <button class="voting-button mt-4" onclick="closeModal('successPopup')">
            Continue
        </button>
    </div>

    <!-- Security Modal -->
    <div id="securityModal" class="fixed inset-0 flex items-center justify-center hidden z-50">
        <div class="hacker-modal w-full max-w-4xl mx-4">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold hacker-text terminal-font" id="modalTitle">SECURITY SCAN RESULTS</h3>
                    <button onclick="closeModal('securityModal')" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div id="modalContent">
                    <!-- Modal content will be dynamically inserted -->
                </div>
            </div>
        </div>
    </div>

    <!-- Dark Mode Toggle -->
    <button id="darkModeToggle" class="dark-mode-toggle">
        <i class="fas fa-moon"></i>
    </button>

    <!-- Audio element for congratulation sound -->
    <audio id="congratulationsSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Enhanced system data with admin credentials as requested
        const systemData = {
            counties: [
                { id: 1, name: "Nairobi" },
                { id: 2, name: "Mombasa" },
                { id: 3, name: "Kisumu" },
                { id: 4, name: "Nakuru" },
                { id: 5, name: "Uasin Gishu" },
                { id: 6, name: "Kakamega" },
                { id: 7, name: "Bungoma" },
                { id: 8, name: "Meru" },
                { id: 9, name: "Kiambu" },
                { id: 10, name: "Machakos" }
            ],
            constituencies: [
                { id: 1, name: "Westlands", countyId: 1 },
                { id: 2, name: "Dagoretti North", countyId: 1 },
                { id: 3, name: "Dagoretti South", countyId: 1 },
                { id: 4, name: "Langata", countyId: 1 },
                { id: 5, name: "Kibra", countyId: 1 },
                { id: 6, name: "Roysambu", countyId: 1 },
                { id: 7, name: "Kasarani", countyId: 1 },
                { id: 8, name: "Ruaraka", countyId: 1 },
                { id: 9, name: "Embakasi South", countyId: 1 },
                { id: 10, name: "Embakasi North", countyId: 1 },
                { id: 11, name: "Embakasi Central", countyId: 1 },
                { id: 12, name: "Embakasi East", countyId: 1 },
                { id: 13, name: "Embakasi West", countyId: 1 },
                { id: 14, name: "Makadara", countyId: 1 },
                { id: 15, name: "Kamukunji", countyId: 1 },
                { id: 16, name: "Starehe", countyId: 1 },
                { id: 17, name: "Mathare", countyId: 1 },
                { id: 18, name: "Mvita", countyId: 2 },
                { id: 19, name: "Likoni", countyId: 2 },
                { id: 20, name: "Kisumu Central", countyId: 3 },
                { id: 21, name: "Kisumu East", countyId: 3 },
                { id: 22, name: "Kisumu West", countyId: 3 },
                { id: 23, name: "Nakuru Town East", countyId: 4 },
                { id: 24, name: "Nakuru Town West", countyId: 4 },
                { id: 25, name: "Turbo", countyId: 5 },
                { id: 26, name: "Kesses", countyId: 5 },
                { id: 27, name: "Lurambi", countyId: 6 },
                { id: 28, name: "Kimilili", countyId: 7 },
                { id: 29, name: "Tigania West", countyId: 8 },
                { id: 30, name: "Kiambu Town", countyId: 9 },
                { id: 31, name: "Machakos Town", countyId: 10 }
            ],
            wards: [
                { id: 1, name: "Kitisuru", constituencyId: 1 },
                { id: 2, name: "Parklands/Highridge", constituencyId: 1 },
                { id: 3, name: "Karura", constituencyId: 1 },
                { id: 4, name: "Kangemi", constituencyId: 1 },
                { id: 5, name: "Mountain View", constituencyId: 1 },
                { id: 6, name: "Kilimani", constituencyId: 2 },
                { id: 7, name: "Kawangware", constituencyId: 2 },
                { id: 8, name: "Gatina", constituencyId: 2 },
                { id: 9, name: "Kileleshwa", constituencyId: 2 },
                { id: 10, name: "Kabiro", constituencyId: 2 },
                { id: 11, name: "Mutuini", constituencyId: 3 },
                { id: 12, name: "Ngando", constituencyId: 3 },
                { id: 13, name: "Riruta", constituencyId: 3 },
                { id: 14, name: "Uthiru/Ruthimitu", constituencyId: 3 },
                { id: 15, name: "Waithaka", constituencyId: 3 },
                { id: 16, name: "Karen", constituencyId: 4 },
                { id: 17, name: "Nairobi West", constituencyId: 4 },
                { id: 18, name: "Mugumoini", constituencyId: 4 },
                { id: 19, name: "South C", constituencyId: 4 },
                { id: 20, name: "Nyayo Highrise", constituencyId: 4 },
                { id: 21, name: "Laini Saba", constituencyId: 5 },
                { id: 22, name: "Lindi", constituencyId: 5 },
                { id: 23, name: "Makina", constituencyId: 5 },
                { id: 24, name: "Woodley/Kenyatta Golf Course", constituencyId: 5 },
                { id: 25, name: "Sarang'ombe", constituencyId: 5 },
                { id: 26, name: "Githurai", constituencyId: 6 },
                { id: 27, name: "Kahawa West", constituencyId: 6 },
                { id: 28, name: "Zimmerman", constituencyId: 6 },
                { id: 29, name: "Roysambu", constituencyId: 6 },
                { id: 30, name: "Kahawa", constituencyId: 6 },
                { id: 31, name: "Clay City", constituencyId: 7 },
                { id: 32, name: "Mwiki", constituencyId: 7 },
                { id: 33, name: "Kasarani", constituencyId: 7 },
                { id: 34, name: "Njiru", constituencyId: 7 },
                { id: 35, name: "Ruai", constituencyId: 7 },
                { id: 36, name: "Baba Dogo", constituencyId: 8 },
                { id: 37, name: "Utalii", constituencyId: 8 },
                { id: 38, name: "Mathare North", constituencyId: 8 },
                { id: 39, name: "Lucky Summer", constituencyId: 8 },
                { id: 40, name: "Korogocho", constituencyId: 8 },
                { id: 41, name: "Imara Daima", constituencyId: 9 },
                { id: 42, name: "Kwa Njenga", constituencyId: 9 },
                { id: 43, name: "Kwa Reuben", constituencyId: 9 },
                { id: 44, name: "Pipeline", constituencyId: 9 },
                { id: 45, name: "Kware", constituencyId: 9 },
                { id: 46, name: "Kariobangi North", constituencyId: 10 },
                { id: 47, name: "Dandora Area I", constituencyId: 10 },
                { id: 48, name: "Dandora Area II", constituencyId: 10 },
                { id: 49, name: "Dandora Area III", constituencyId: 10 },
                { id: 50, name: "Dandora Area IV", constituencyId: 10 },
                { id: 51, name: "Kayole North", constituencyId: 11 },
                { id: 52, name: "Kayole Central", constituencyId: 11 },
                { id: 53, name: "Kayole South", constituencyId: 11 },
                { id: 54, name: "Komarock", constituencyId: 11 },
                { id: 55, name: "Matopeni/Spring Valley", constituencyId: 11 },
                { id: 56, name: "Upper Savanna", constituencyId: 12 },
                { id: 57, name: "Lower Savanna", constituencyId: 12 },
                { id: 58, name: "Embakasi", constituencyId: 12 },
                { id: 59, name: "Utawala", constituencyId: 12 },
                { id: 60, name: "Mihang'o", constituencyId: 12 },
                { id: 61, name: "Umoja I", constituencyId: 13 },
                { id: 62, name: "Umoja II", constituencyId: 13 },
                { id: 63, name: "Mowlem", constituencyId: 13 },
                { id: 64, name: "Kariobangi South", constituencyId: 13 },
                { id: 65, name: "Maringo/Hamza", constituencyId: 13 },
                { id: 66, name: "Viwandani", constituencyId: 14 },
                { id: 67, name: "Harambee", constituencyId: 14 },
                { id: 68, name: "Makongeni", constituencyId: 14 },
                { id: 69, name: "Mbotela", constituencyId: 14 },
                { id: 70, name: "Maringo/Hamza", constituencyId: 14 },
                { id: 71, name: "Pumwani", constituencyId: 15 },
                { id: 72, name: "Eastleigh North", constituencyId: 15 },
                { id: 73, name: "Eastleigh South", constituencyId: 15 },
                { id: 74, name: "Airbase", constituencyId: 15 },
                { id: 75, name: "California", constituencyId: 15 },
                { id: 76, name: "Nairobi Central", constituencyId: 16 },
                { id: 77, name: "Ngara", constituencyId: 16 },
                { id: 78, name: "Pangani", constituencyId: 16 },
                { id: 79, name: "Ziwani/Kariokor", constituencyId: 16 },
                { id: 80, name: "Landimawe", constituencyId: 16 },
                { id: 81, name: "Nairobi South", constituencyId: 16 },
                { id: 82, name: "Hospital", constituencyId: 17 },
                { id: 83, name: "Mabatini", constituencyId: 17 },
                { id: 84, name: "Huruma", constituencyId: 17 },
                { id: 85, name: "Ngei", constituencyId: 17 },
                { id: 86, name: "Mlango Kubwa", constituencyId: 17 },
                { id: 87, name: "Kiamaiko", constituencyId: 17 }
            ],
            candidates: [
                // Presidential candidates (national)
                { id: 1, name: "James Mwangi", party: "Unity Party", position: "president", countyId: null, constituencyId: null, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                { id: 2, name: "John Omondi", party: "Kenya Forward", position: "president", countyId: null, constituencyId: null, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                { id: 3, name: "David Kimani", party: "Progressive Alliance", position: "president", countyId: null, constituencyId: null, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                
                // Governor candidates (Nairobi)
                { id: 4, name: "Johnson Sakaja", party: "UDA", position: "governor", countyId: 1, constituencyId: null, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                { id: 5, name: "Polycarp Igathe", party: "Jubilee", position: "governor", countyId: 1, constituencyId: null, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                { id: 6, name: "Agnes Kagure", party: "ODM", position: "governor", countyId: 1, constituencyId: null, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                
                // Governor candidates (Mombasa)
                { id: 7, name: "Abdulswamad Nassir", party: "ODM", position: "governor", countyId: 2, constituencyId: null, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                { id: 8, name: "Hassan Omar", party: "UDA", position: "governor", countyId: 2, constituencyId: null, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                
                // Senator candidates (Nairobi)
                { id: 9, name: "Edwin Sifuna", party: "ODM", position: "senator", countyId: 1, constituencyId: null, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                { id: 10, name: "Bishop Margaret Wanjiru", party: "UDA", position: "senator", countyId: 1, constituencyId: null, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                
                // Women Representative candidates (Nairobi)
                { id: 11, name: "Esther Passaris", party: "ODM", position: "women_rep", countyId: 1, constituencyId: null, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                { id: 12, name: "Millicent Omanga", party: "UDA", position: "women_rep", countyId: 1, constituencyId: null, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                
                // MP candidates (Westlands)
                { id: 13, name: "Timothy Wanyonyi", party: "ODM", position: "mp", countyId: 1, constituencyId: 1, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                { id: 14, name: "Nelson Havi", party: "UDA", position: "mp", countyId: 1, constituencyId: 1, wardId: null, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                
                // MCA candidates (Kitisuru)
                { id: 15, name: "Anthony Kiragu", party: "UDA", position: "mca", countyId: 1, constituencyId: 1, wardId: 1, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" },
                { id: 16, name: "Patricia Mutheu", party: "ODM", position: "mca", countyId: 1, constituencyId: 1, wardId: 1, photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png" }
            ],
            voters: [],
            adminCredentials: {
                username: "admin",
                password: "12345", // Updated password as requested
                systemCode: "KIEGE2024"
            }
        };

        // Current user data
        let currentUser = null;
        let currentVoter = null;

        // Initialize the system
        document.addEventListener('DOMContentLoaded', function() {
            // Set initial time
            document.getElementById('initTime').textContent = new Date().toLocaleString();
            updateTime();
            setInterval(updateTime, 1000);
            
            // Initialize matrix rain
            initMatrixRain();
            
            // Initialize network visualization
            initNetworkVisualization();
            
            // Initialize charts
            initCharts();
            
            // Set up event listeners
            setupEventListeners();
            
            // Initialize voting interface
            initVotingInterface();
            
            // Populate county, constituency and ward selectors
            populateLocationSelectors();
            
            // Initialize chatbot
            setupChatbot();
            
            // Show role selection modal on first load
            setTimeout(() => {
                document.getElementById('roleSelectionModal').classList.remove('hidden');
            }, 1000);
            
            // Initialize DDoS protection
            initDDoSProtection();
            
            // Initialize blockchain verification
            initBlockchainVerification();
        });

        // Matrix Rain Effect
        function initMatrixRain() {
            const canvas = document.getElementById('matrixRain');
            const ctx = canvas.getContext('2d');
            
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const chars = "01010101010101010101010101010101";
            const charArray = chars.split("");
            const fontSize = 14;
            const columns = canvas.width / fontSize;
            const drops = [];
            
            for(let x = 0; x < columns; x++) {
                drops[x] = 1;
            }
            
            function draw() {
                ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = "#0F0";
                ctx.font = fontSize + "px monospace";
                
                for(let i = 0; i < drops.length; i++) {
                    const text = charArray[Math.floor(Math.random() * charArray.length)];
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                    
                    if(drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    drops[i]++;
                }
            }
            
            setInterval(draw, 33);
        }

        // Populate location selectors
        function populateLocationSelectors() {
            // Populate county selectors
            const countySelectors = document.querySelectorAll('select[id$="county"]');
            countySelectors.forEach(selector => {
                systemData.counties.forEach(county => {
                    const option = document.createElement('option');
                    option.value = county.id;
                    option.textContent = county.name;
                    selector.appendChild(option);
                });
            });

            // Populate constituency selectors
            const constituencySelectors = document.querySelectorAll('select[id$="constituency"]');
            constituencySelectors.forEach(selector => {
                // Add event listener to filter by county
                const countySelector = document.getElementById(selector.id.replace('constituency', 'county'));
                if (countySelector) {
                    countySelector.addEventListener('change', function() {
                        const countyId = this.value;
                        updateConstituencySelector(selector, countyId);
                    });
                }
                
                // Initial population
                updateConstituencySelector(selector);
            });

            // Populate ward selectors
            const wardSelectors = document.querySelectorAll('select[id$="ward"]');
            wardSelectors.forEach(selector => {
                // Add event listener to filter by constituency
                const constituencySelector = document.getElementById(selector.id.replace('ward', 'constituency'));
                if (constituencySelector) {
                    constituencySelector.addEventListener('change', function() {
                        const constituencyId = this.value;
                        updateWardSelector(selector, constituencyId);
                    });
                }
                
                // Initial population
                updateWardSelector(selector);
            });
        }

        function updateConstituencySelector(selector, countyId = null) {
            // Clear existing options
            selector.innerHTML = '<option value="">Select Constituency</option>';
            
            // Filter constituencies by county
            const filteredConstituencies = countyId 
                ? systemData.constituencies.filter(c => c.countyId == countyId)
                : systemData.constituencies;
            
            // Add filtered constituencies
            filteredConstituencies.forEach(constituency => {
                const option = document.createElement('option');
                option.value = constituency.id;
                option.textContent = constituency.name;
                selector.appendChild(option);
            });
        }

        function updateWardSelector(selector, constituencyId = null) {
            // Clear existing options
            selector.innerHTML = '<option value="">Select Ward</option>';
            
            // Filter wards by constituency
            const filteredWards = constituencyId 
                ? systemData.wards.filter(w => w.constituencyId == constituencyId)
                : systemData.wards;
            
            // Add filtered wards
            filteredWards.forEach(ward => {
                const option = document.createElement('option');
                option.value = ward.id;
                option.textContent = ward.name;
                selector.appendChild(option);
            });
        }

        // Voting Interface Functions
        function initVotingInterface() {
            // Load candidates for voter
            loadCandidatesForVoter();
        }

        function loadCandidatesForVoter() {
            // Clear existing candidates
            const containers = [
                'presidential-candidates-container',
                'governor-candidates-container',
                'senator-candidates-container',
                'women-rep-candidates-container',
                'mp-candidates-container',
                'mca-candidates-container'
            ];
            
            containers.forEach(containerId => {
                const container = document.getElementById(containerId);
                if (container) {
                    container.innerHTML = '';
                }
            });
            
            // Load presidential candidates (national)
            const presidentialCandidates = systemData.candidates.filter(c => c.position === 'president');
            populateCandidateContainer('presidential-candidates-container', presidentialCandidates, 'president');
            
            // Load governor candidates (county level)
            const governorCandidates = systemData.candidates.filter(c => 
                c.position === 'governor'
            );
            populateCandidateContainer('governor-candidates-container', governorCandidates, 'governor');
            
            // Load senator candidates (county level)
            const senatorCandidates = systemData.candidates.filter(c => 
                c.position === 'senator'
            );
            populateCandidateContainer('senator-candidates-container', senatorCandidates, 'senator');
            
            // Load women representative candidates (county level)
            const womenRepCandidates = systemData.candidates.filter(c => 
                c.position === 'women_rep'
            );
            populateCandidateContainer('women-rep-candidates-container', womenRepCandidates, 'women_rep');
            
            // Load MP candidates (constituency level)
            const mpCandidates = systemData.candidates.filter(c => 
                c.position === 'mp'
            );
            populateCandidateContainer('mp-candidates-container', mpCandidates, 'mp');
            
            // Load MCA candidates (ward level)
            const mcaCandidates = systemData.candidates.filter(c => 
                c.position === 'mca'
            );
            populateCandidateContainer('mca-candidates-container', mcaCandidates, 'mca');
        }

        function populateCandidateContainer(containerId, candidates, position) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            if (candidates.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500 py-4">No candidates available for this position in your area.</p>';
                return;
            }
            
            candidates.forEach(candidate => {
                const candidateElement = document.createElement('div');
                candidateElement.className = 'candidate-item';
                candidateElement.setAttribute('data-position', position);
                candidateElement.setAttribute('data-candidate-id', candidate.id);
                
                candidateElement.innerHTML = `
                    <img src="${candidate.photo}" alt="${candidate.name}" class="candidate-photo">
                    <div class="candidate-info">
                        <div class="candidate-name">${candidate.name}</div>
                        <div class="candidate-party">${candidate.party}</div>
                    </div>
                    <div class="custom-radio">
                        <input type="radio" name="${position}" id="${position}-${candidate.id}" value="${candidate.id}">
                        <label for="${position}-${candidate.id}"></label>
                    </div>
                `;
                
                container.appendChild(candidateElement);
            });
            
            // Set up candidate selection
            container.querySelectorAll('.candidate-item').forEach(item => {
                item.addEventListener('click', function() {
                    const position = this.getAttribute('data-position');
                    const candidateId = this.getAttribute('data-candidate-id');
                    
                    // Deselect all candidates for this position
                    document.querySelectorAll(`.candidate-item[data-position="${position}"]`).forEach(candidate => {
                        candidate.classList.remove('selected');
                    });
                    
                    // Select this candidate
                    this.classList.add('selected');
                    
                    // Update the vote summary
                    updateVoteSummary(position, candidateId);
                    
                    // Update progress
                    updateProgress();
                });
            });
        }

        function updateVoteSummary(position, candidateId) {
            const positionNames = {
                president: "President & Deputy",
                governor: "Governor & Deputy",
                senator: "Senator",
                women_rep: "Women Representative",
                mp: "Member of Parliament",
                mca: "Member of County Assembly"
            };
            
            const candidate = systemData.candidates.find(c => c.id == candidateId);
            if (!candidate) return;
            
            // Find the summary item for this position
            const summaryItems = document.querySelectorAll('.summary-item');
            summaryItems.forEach(item => {
                const positionText = item.querySelector('.summary-position').textContent;
                if (positionText === positionNames[position]) {
                    const candidateText = item.querySelector('.summary-candidate');
                    candidateText.textContent = `${candidate.name} (${candidate.party})`;
                    candidateText.classList.remove('empty-selection');
                }
            });
        }

        function updateProgress() {
            const selectedCount = document.querySelectorAll('.candidate-item.selected').length;
            const totalPositions = 6;
            const progressPercentage = (selectedCount / totalPositions) * 100;
            
            document.getElementById('progressFill').style.width = `${progressPercentage}%`;
            
            // Update step indicators
            const steps = document.querySelectorAll('.progress-step');
            steps.forEach((step, index) => {
                if (index < selectedCount + 1) {
                    step.classList.add('step-completed');
                    step.classList.remove('step-active');
                } else if (index === selectedCount + 1) {
                    step.classList.add('step-active');
                    step.classList.remove('step-completed');
                } else {
                    step.classList.remove('step-active', 'step-completed');
                }
            });
            
            // Enable/disable navigation buttons
            const prevBtn = document.getElementById('prev-step-btn');
            const nextBtn = document.getElementById('next-step-btn');
            
            if (selectedCount === totalPositions) {
                nextBtn.textContent = 'Submit Vote';
                nextBtn.onclick = submitVote;
            } else {
                nextBtn.textContent = 'Next';
                nextBtn.onclick = nextStep;
            }
        }

        function nextStep() {
            // For now, just scroll to next section
            // In a real implementation, this would navigate between steps
            window.scrollBy(0, 500);
        }

        function submitVote() {
            // Play congratulation sound
            const audio = document.getElementById('congratulationsSound');
            audio.play().catch(e => console.log('Audio play failed:', e));
            
            // Show success popup with flowers
            document.getElementById('successPopup').classList.remove('hidden');
            
            // Create confetti effect
            createConfetti();
            
            // After a delay, show the confirmation modal
            setTimeout(() => {
                document.getElementById('successPopup').classList.add('hidden');
                document.getElementById('votingConfirmationModal').classList.remove('hidden');
                
                // Set receipt details
                document.getElementById('receiptVoterId').textContent = currentVoter.nationalId;
                document.getElementById('receiptTimestamp').textContent = new Date().toLocaleString();
                document.getElementById('receiptTransactionId').textContent = 'TX-' + Math.random().toString(36).substring(2, 10).toUpperCase() + '-IEBC';
                
                // Mark voter as having voted
                currentVoter.hasVoted = true;
                
                // Generate voting certificate
                generateVotingCertificate();
            }, 3000);
        }

        function createConfetti() {
            // Use canvas-confetti library
            confetti({
                particleCount: 150,
                spread: 70,
                origin: { y: 0.6 }
            });
        }

        function generateVotingCertificate() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add IEBC logo
            doc.setFontSize(20);
            doc.setTextColor(0, 135, 81);
            doc.text('IEBC VOTING CERTIFICATE', 105, 20, { align: 'center' });
            
            // Add voter info
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('Voter ID: ' + currentVoter.nationalId, 20, 40);
            doc.text('Name: ' + currentVoter.fullName, 20, 50);
            doc.text('County: ' + systemData.counties.find(c => c.id == currentVoter.countyId).name, 20, 60);
            doc.text('Timestamp: ' + new Date().toLocaleString(), 20, 70);
            doc.text('Transaction ID: ' + document.getElementById('receiptTransactionId').textContent, 20, 80);
            
            // Add line
            doc.setDrawColor(0, 135, 81);
            doc.setLineWidth(0.5);
            doc.line(20, 85, 190, 85);
            
            // Add vote summary
            doc.setFontSize(14);
            doc.setTextColor(0, 135, 81);
            doc.text('YOUR VOTE SUMMARY', 105, 95, { align: 'center' });
            
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            
            let yPosition = 105;
            const selectedCandidates = document.querySelectorAll('.candidate-item.selected');
            selectedCandidates.forEach(candidate => {
                const position = candidate.getAttribute('data-position');
                const candidateId = candidate.getAttribute('data-candidate-id');
                const candidateData = systemData.candidates.find(c => c.id == candidateId);
                
                if (candidateData) {
                    const positionNames = {
                        president: "President",
                        governor: "Governor",
                        senator: "Senator",
                        women_rep: "Women Representative",
                        mp: "Member of Parliament",
                        mca: "Member of County Assembly"
                    };
                    
                    doc.text(`${positionNames[position]}: ${candidateData.name} (${candidateData.party})`, 20, yPosition);
                    yPosition += 7;
                }
            });
            
            // Add watermark
            doc.setFontSize(60);
            doc.setTextColor(200, 200, 200);
            doc.text('VALID', 105, 140, { align: 'center', angle: 45 });
            
            // Save the PDF
            doc.save('IEBC_Voting_Certificate.pdf');
        }

        // Admin Functions
        function addCandidate() {
            const name = document.getElementById('candidate-name').value;
            const party = document.getElementById('candidate-party').value;
            const position = document.getElementById('candidate-position').value;
            const countyId = document.getElementById('candidate-county').value;
            const constituencyId = document.getElementById('candidate-constituency').value;
            const wardId = document.getElementById('candidate-ward').value;
            
            if (!name || !party || !position) {
                alert('Please fill in all required fields');
                return;
            }
            
            // Create new candidate
            const newCandidate = {
                id: systemData.candidates.length + 1,
                name: name,
                party: party,
                position: position,
                countyId: countyId || null,
                constituencyId: constituencyId || null,
                wardId: wardId || null,
                photo: "https://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png"
            };
            
            systemData.candidates.push(newCandidate);
            
            // Clear form
            document.getElementById('candidate-name').value = '';
            document.getElementById('candidate-party').value = '';
            
            // Refresh candidates list
            refreshCandidatesList();
            
            alert('Candidate added successfully!');
        }

        function refreshCandidatesList() {
            const candidatesList = document.getElementById('candidates-list');
            if (!candidatesList) return;
            
            candidatesList.innerHTML = '';
            
            systemData.candidates.forEach(candidate => {
                const candidateItem = document.createElement('div');
                candidateItem.className = 'candidate-list-item';
                
                const positionNames = {
                    president: "President",
                    governor: "Governor",
                    senator: "Senator",
                    women_rep: "Women Representative",
                    mp: "Member of Parliament",
                    mca: "Member of County Assembly"
                };
                
                candidateItem.innerHTML = `
                    <img src="${candidate.photo}" alt="${candidate.name}">
                    <div class="candidate-list-info">
                        <div class="candidate-name">${candidate.name}</div>
                        <div class="candidate-party">${candidate.party} - ${positionNames[candidate.position]}</div>
                    </div>
                    <div class="candidate-list-actions">
                        <button class="voting-button" onclick="editCandidate(${candidate.id})">Edit</button>
                        <button class="admin-button" onclick="deleteCandidate(${candidate.id})">Delete</button>
                    </div>
                `;
                
                candidatesList.appendChild(candidateItem);
            });
        }

        function editCandidate(id) {
            // Implementation for editing a candidate
            alert('Edit candidate with ID: ' + id);
        }

        function deleteCandidate(id) {
            if (confirm('Are you sure you want to delete this candidate?')) {
                systemData.candidates = systemData.candidates.filter(c => c.id !== id);
                refreshCandidatesList();
                alert('Candidate deleted successfully!');
            }
        }

        function addCounty() {
            const name = document.getElementById('new-county-name').value;
            
            if (!name) {
                alert('Please enter a county name');
                return;
            }
            
            // Add new county
            const newCounty = {
                id: systemData.counties.length + 1,
                name: name
            };
            
            systemData.counties.push(newCounty);
            
            // Clear form
            document.getElementById('new-county-name').value = '';
            
            // Refresh county selectors
            populateLocationSelectors();
            
            alert('County added successfully!');
        }

        function addConstituency() {
            const name = document.getElementById('new-constituency-name').value;
            const countyId = document.getElementById('constituency-county').value;
            
            if (!name || !countyId) {
                alert('Please fill in all fields');
                return;
            }
            
            // Add new constituency
            const newConstituency = {
                id: systemData.constituencies.length + 1,
                name: name,
                countyId: parseInt(countyId)
            };
            
            systemData.constituencies.push(newConstituency);
            
            // Clear form
            document.getElementById('new-constituency-name').value = '';
            
            // Refresh constituency selectors
            populateLocationSelectors();
            
            alert('Constituency added successfully!');
        }

        function addWard() {
            const name = document.getElementById('new-ward-name').value;
            const constituencyId = document.getElementById('ward-constituency').value;
            
            if (!name || !constituencyId) {
                alert('Please fill in all fields');
                return;
            }
            
            // Add new ward
            const newWard = {
                id: systemData.wards.length + 1,
                name: name,
                constituencyId: parseInt(constituencyId)
            };
            
            systemData.wards.push(newWard);
            
            // Clear form
            document.getElementById('new-ward-name').value = '';
            
            // Refresh ward selectors
            populateLocationSelectors();
            
            alert('Ward added successfully!');
        }

        function updateAdminCredentials() {
            const newPassword = document.getElementById('admin-password-change').value;
            const newCode = document.getElementById('admin-code-change').value;
            
            if (newPassword) {
                systemData.adminCredentials.password = newPassword;
                document.getElementById('admin-password-change').value = '';
            }
            
            if (newCode) {
                systemData.adminCredentials.systemCode = newCode;
                document.getElementById('admin-code-change').value = '';
            }
            
            alert('Admin credentials updated successfully!');
        }

        function downloadSystemLogs() {
            const logs = `KIEGE System Logs - ${new Date().toLocaleString()}\n\n`;
            const blob = new Blob([logs], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `kiege-logs-${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
        }

        // Chatbot Functions
        function setupChatbot() {
            const chatbotSend = document.getElementById('chatbot-send');
            const chatbotInput = document.getElementById('chatbot-input');
            
            chatbotSend.addEventListener('click', sendChatbotMessage);
            chatbotInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendChatbotMessage();
                }
            });
        }

        function sendChatbotMessage() {
            const input = document.getElementById('chatbot-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message to chat
            addChatbotMessage(message, 'user');
            
            // Clear input
            input.value = '';
            
            // Generate bot response
            setTimeout(() => {
                const response = generateChatbotResponse(message);
                addChatbotMessage(response, 'bot');
            }, 1000);
        }

        function addChatbotMessage(message, sender) {
            const messagesContainer = document.getElementById('chatbot-messages');
            const messageElement = document.createElement('div');
            messageElement.className = `message ${sender}`;
            messageElement.textContent = message;
            messagesContainer.appendChild(messageElement);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function generateChatbotResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('register') || lowerMessage.includes('sign up')) {
                return "To register as a voter, you need to visit the voter registration portal with your national ID. You can also register at your local IEBC office.";
            } else if (lowerMessage.includes('vote') || lowerMessage.includes('voting')) {
                return "You can vote at your designated polling station on election day. Make sure to bring your national ID for verification.";
            } else if (lowerMessage.includes('candidate') || lowerMessage.includes('candidates')) {
                return "Candidates are registered by political parties and independent candidates. You can view all candidates for your area in the voting portal.";
            } else if (lowerMessage.includes('result') || lowerMessage.includes('results')) {
                return "Election results are available in real-time on the KIEGE platform. You can view results by county or for the entire nation.";
            } else if (lowerMessage.includes('help')) {
                return "I can help you with information about voter registration, voting procedures, candidates, and election results. What would you like to know?";
            } else {
                return "I'm here to help with questions about the Kenyan electoral process. You can ask me about voter registration, voting, candidates, or results.";
            }
        }

        // Security Functions
        function initDDoSProtection() {
            // Simulate DDoS protection system
            setInterval(() => {
                const blockedRequests = Math.floor(Math.random() * 100) + 12000;
                document.querySelector('.cyber-card.p-4.text-center:nth-child(2) .text-2xl').textContent = blockedRequests.toLocaleString();
            }, 5000);
        }

        function initBlockchainVerification() {
            // Simulate blockchain verification system
            setInterval(() => {
                const totalBlocks = 1247892 + Math.floor(Math.random() * 100);
                document.querySelector('.cyber-card.p-4.text-center:nth-child(1) .text-2xl').textContent = totalBlocks.toLocaleString();
            }, 7000);
        }

        function simulateDDoSAttack() {
            const ddosStatus = document.getElementById('ddosStatus');
            ddosStatus.textContent = "DDoS Protection: UNDER ATTACK - Mitigating 12,450 requests/second";
            ddosStatus.classList.add('security-alert');
            
            // Update metrics
            document.querySelector('.cyber-card.p-4.text-center:nth-child(1) .text-2xl').textContent = "1";
            document.querySelector('.cyber-card.p-4.text-center:nth-child(2) .text-2xl').textContent = "12,450";
            document.querySelector('.cyber-card.p-4.text-center:nth-child(3) .text-2xl').textContent = "99.8%";
            
            // Log to terminal
            logToTerminal("[CRITICAL] DDoS attack detected - activating mitigation protocols");
            
            // Reset after 5 seconds
            setTimeout(() => {
                ddosStatus.textContent = "DDoS Protection: ACTIVE - No attacks detected";
                ddosStatus.classList.remove('security-alert');
                document.querySelector('.cyber-card.p-4.text-center:nth-child(1) .text-2xl').textContent = "0";
            }, 5000);
        }

        function verifyBlockchain() {
            const blockchainStatus = document.getElementById('blockchainStatus');
            blockchainStatus.textContent = "Blockchain Integrity: VERIFYING - Checking all blocks...";
            
            // Simulate verification process
            setTimeout(() => {
                blockchainStatus.textContent = "Blockchain Integrity: VERIFIED - All blocks cryptographically signed";
                blockchainStatus.classList.add('blockchain-verified');
                
                // Update metrics
                document.querySelector('.cyber-card.p-4.text-center:nth-child(3) .text-2xl').textContent = "0";
                
                // Log to terminal
                logToTerminal("[SUCCESS] Blockchain verification completed - no tampering detected");
            }, 3000);
        }

        // Setup event listeners
        function setupEventListeners() {
            // Sidebar navigation
            document.querySelectorAll('.sidebar-link[data-mode]').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    const mode = this.getAttribute('data-mode');
                    document.querySelectorAll('.mode-view').forEach(view => view.classList.add('hidden'));
                    document.getElementById(`${mode}-mode`).classList.remove('hidden');
                    
                    // Special handling for admin mode
                    if (mode === 'admin' && !currentUser) {
                        document.getElementById('admin-login-screen').classList.remove('hidden');
                        document.getElementById('admin-dashboard').classList.add('hidden');
                    }
                    
                    // Initialize chatbot if needed
                    if (mode === 'chatbot') {
                        setupChatbot();
                    }
                });
            });

            // Security actions
            document.querySelectorAll('.sidebar-link[data-action]').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const action = this.getAttribute('data-action');
                    
                    switch(action) {
                        case 'security-scan':
                            startVotingSecurityScan();
                            break;
                        case 'pen-test':
                            startPenTest();
                            break;
                        case 'blockchain-check':
                            testBlockchainIntegrity();
                            break;
                        case 'network-monitor':
                            showNetworkMonitor();
                            break;
                        case 'ddos-protection':
                            showDDoSProtection();
                            break;
                        case 'threat-analysis':
                            showThreatAnalysis();
                            break;
                    }
                });
            });

            // Voter registration
            document.getElementById('voter-registration-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const fullName = document.getElementById('full-name').value;
                const nationalId = document.getElementById('national-id').value;
                const phoneNumber = document.getElementById('phone-number').value;
                const countyId = document.getElementById('county').value;
                const constituencyId = document.getElementById('constituency').value;
                const wardId = document.getElementById('ward').value;
                
                // Check if voter already exists
                const existingVoter = systemData.voters.find(v => v.nationalId === nationalId);
                if (existingVoter) {
                    alert('A voter with this national ID is already registered.');
                    return;
                }
                
                // Create new voter
                const newVoter = {
                    id: systemData.voters.length + 1,
                    fullName: fullName,
                    nationalId: nationalId,
                    phoneNumber: phoneNumber,
                    countyId: parseInt(countyId),
                    constituencyId: parseInt(constituencyId),
                    wardId: parseInt(wardId),
                    hasVoted: false
                };
                
                systemData.voters.push(newVoter);
                currentVoter = newVoter;
                
                // Proceed to voting dashboard
                document.getElementById('voter-registration-screen').classList.add('hidden');
                document.getElementById('voting-dashboard').classList.remove('hidden');
                
                // Load candidates for this voter's area
                loadCandidatesForVoter();
                
                updateProgress();
            });

            // Voter login
            document.getElementById('voting-login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const nationalId = document.getElementById('login-national-id').value;
                
                // Find voter
                const voter = systemData.voters.find(v => v.nationalId === nationalId);
                if (!voter) {
                    alert('No voter found with this national ID. Please register first.');
                    return;
                }
                
                if (voter.hasVoted) {
                    alert('You have already voted. Each voter can only vote once.');
                    return;
                }
                
                currentVoter = voter;
                
                // Proceed to voting dashboard
                document.getElementById('voting-login-screen').classList.add('hidden');
                document.getElementById('voting-dashboard').classList.remove('hidden');
                
                // Load candidates for this voter's area
                loadCandidatesForVoter();
                
                updateProgress();
            });

            // Admin login
            document.getElementById('admin-login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const username = document.getElementById('admin-username').value;
                const password = document.getElementById('admin-password').value;
                const systemCode = document.getElementById('admin-code').value;
                
                if (username === systemData.adminCredentials.username && 
                    password === systemData.adminCredentials.password && 
                    systemCode === systemData.adminCredentials.systemCode) {
                    
                    currentUser = { role: 'admin' };
                    
                    document.getElementById('admin-login-screen').classList.add('hidden');
                    document.getElementById('admin-dashboard').classList.remove('hidden');
                    
                    // Initialize admin dashboard
                    refreshCandidatesList();
                    
                } else {
                    alert('Invalid admin credentials. Please try again.');
                }
            });

            // Admin tabs
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    // Update active tab
                    document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show corresponding content
                    document.querySelectorAll('.admin-content').forEach(content => content.classList.remove('active'));
                    document.getElementById(`admin-${tabName}-tab`).classList.add('active');
                });
            });

            // Show voter login from registration
            document.getElementById('show-voter-login').addEventListener('click', function() {
                document.getElementById('voter-registration-screen').classList.add('hidden');
                document.getElementById('voting-login-screen').classList.remove('hidden');
            });

            // Show voter registration from login
            document.getElementById('show-voter-registration').addEventListener('click', function() {
                document.getElementById('voting-login-screen').classList.add('hidden');
                document.getElementById('voter-registration-screen').classList.remove('hidden');
            });

            // System mode toggle
            document.getElementById('system-mode-toggle').addEventListener('click', function() {
                const currentMode = document.querySelector('.sidebar-link.active[data-mode]').getAttribute('data-mode');
                const nextMode = currentMode === 'security' ? 'voting' : 'security';
                
                document.querySelector(`.sidebar-link[data-mode="${nextMode}"]`).click();
            });

            // Role selection
            document.querySelectorAll('.role-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.role-option').forEach(o => {
                        o.classList.remove('border-green-500', 'border-blue-500', 'border-red-500');
                        o.classList.add('border-gray-200');
                    });
                    
                    const role = this.getAttribute('data-role');
                    this.classList.remove('border-gray-200');
                    
                    if (role === 'admin') {
                        this.classList.add('border-red-500');
                    } else if (role === 'official') {
                        this.classList.add('border-blue-500');
                    } else {
                        this.classList.add('border-green-500');
                    }
                    
                    document.getElementById('confirmRoleButton').setAttribute('data-selected-role', role);
                });
            });

            document.getElementById('confirmRoleButton').addEventListener('click', function() {
                const selectedRole = this.getAttribute('data-selected-role');
                if (!selectedRole) {
                    alert('Please select a role');
                    return;
                }
                
                document.getElementById('roleSelectionModal').classList.add('hidden');
                document.getElementById('logout-btn-header').classList.remove('hidden');
                
                // Show appropriate dashboard based on role
                if (selectedRole === 'admin') {
                    document.querySelector('.sidebar-link[data-mode="admin"]').click();
                } else if (selectedRole === 'official') {
                    document.querySelector('.sidebar-link[data-mode="official"]').click();
                } else {
                    document.querySelector('.sidebar-link[data-mode="voting"]').click();
                }
                
                // Update header with role badge
                const header = document.querySelector('header .container');
                const existingBadge = header.querySelector('.role-badge');
                if (existingBadge) {
                    existingBadge.remove();
                }
                
                const roleBadge = document.createElement('div');
                roleBadge.className = `role-badge role-${selectedRole} ml-4`;
                roleBadge.innerHTML = `<i class="fas fa-${selectedRole === 'admin' ? 'user-shield' : selectedRole === 'official' ? 'user-tie' : 'user'} mr-1"></i> ${selectedRole.charAt(0).toUpperCase() + selectedRole.slice(1)}`;
                header.appendChild(roleBadge);
            });

            // Logout
            document.getElementById('logout-btn-header').addEventListener('click', function() {
                currentUser = null;
                currentVoter = null;
                
                // Hide all mode views
                document.querySelectorAll('.mode-view').forEach(view => view.classList.add('hidden'));
                
                // Show role selection modal
                document.getElementById('roleSelectionModal').classList.remove('hidden');
                
                // Remove role badge
                const header = document.querySelector('header .container');
                const roleBadge = header.querySelector('.role-badge');
                if (roleBadge) {
                    roleBadge.remove();
                }
                
                // Hide logout button
                this.classList.add('hidden');
            });

            // Dark mode toggle
            document.getElementById('darkModeToggle').addEventListener('click', function() {
                document.body.classList.toggle('dark');
                const icon = this.querySelector('i');
                if (document.body.classList.contains('dark')) {
                    icon.classList.remove('fa-moon');
                    icon.classList.add('fa-sun');
                } else {
                    icon.classList.remove('fa-sun');
                    icon.classList.add('fa-moon');
                }
            });
        }

        // Initialize charts
        function initCharts() {
            // Presidential Results Chart
            const presidentialCtx = document.getElementById('presidentialChart').getContext('2d');
            new Chart(presidentialCtx, {
                type: 'bar',
                data: {
                    labels: ['James Mwangi', 'John Omondi', 'David Kimani'],
                    datasets: [{
                        label: 'Votes',
                        data: [4500000, 3800000, 1200000],
                        backgroundColor: [
                            'rgba(0, 135, 81, 0.8)',
                            'rgba(176, 0, 32, 0.8)',
                            'rgba(255, 165, 0, 0.8)'
                        ],
                        borderColor: [
                            'rgb(0, 135, 81)',
                            'rgb(176, 0, 32)',
                            'rgb(255, 165, 0)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Presidential Election Results'
                        }
                    }
                }
            });

            // Governor Results Chart
            const governorCtx = document.getElementById('governorChart').getContext('2d');
            new Chart(governorCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Johnson Sakaja', 'Polycarp Igathe', 'Others'],
                    datasets: [{
                        data: [55, 40, 5],
                        backgroundColor: [
                            'rgba(0, 135, 81, 0.8)',
                            'rgba(176, 0, 32, 0.8)',
                            'rgba(100, 100, 100, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Nairobi Governor Results'
                        }
                    }
                }
            });
        }

        // Security Functions
        function startVotingSecurityScan() {
            const modal = document.getElementById('securityModal');
            const content = document.getElementById('modalContent');
            const title = document.getElementById('modalTitle');
            
            title.textContent = 'VOTING SECURITY AUDIT';
            content.innerHTML = `
                <div class="text-center py-8">
                    <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500"></div>
                    <p class="mt-4 text-green-400">Running comprehensive security audit...</p>
                </div>
            `;
            
            modal.classList.remove('hidden');
            
            setTimeout(() => {
                showSecurityResults();
            }, 3000);
        }

        function showSecurityResults() {
            const content = document.getElementById('modalContent');
            
            content.innerHTML = `
                <div class="space-y-4">
                    <div class="flex justify-between items-center p-4 border border-green-500 rounded">
                        <div>
                            <h4 class="font-bold text-green-400">Blockchain Integrity</h4>
                            <p class="text-sm text-gray-400">All votes cryptographically verified</p>
                        </div>
                        <span class="px-3 py-1 bg-green-900 text-green-400 rounded text-sm">SECURE</span>
                    </div>
                    
                    <div class="flex justify-between items-center p-4 border border-yellow-500 rounded">
                        <div>
                            <h4 class="font-bold text-yellow-400">Database Encryption</h4>
                            <p class="text-sm text-gray-400">AES-256 encryption active</p>
                        </div>
                        <span class="px-3 py-1 bg-yellow-900 text-yellow-400 rounded text-sm">WARNING</span>
                    </div>
                    
                    <div class="flex justify-between items-center p-4 border border-green-500 rounded">
                        <div>
                            <h4 class="font-bold text-green-400">Network Security</h4>
                            <p class="text-sm text-gray-400">All nodes authenticated</p>
                        </div>
                        <span class="px-3 py-1 bg-green-900 text-green-400 rounded text-sm">SECURE</span>
                    </div>
                    
                    <div class="flex justify-between items-center p-4 border border-red-500 rounded">
                        <div>
                            <h4 class="font-bold text-red-400">DDoS Protection</h4>
                            <p class="text-sm text-gray-400">Rate limiting needs configuration</p>
                        </div>
                        <span class="px-3 py-1 bg-red-900 text-red-400 rounded text-sm">CRITICAL</span>
                    </div>
                </div>
                
                <div class="mt-6 text-center">
                    <button class="cyber-button" onclick="closeModal('securityModal')">
                        <i class="fas fa-check mr-2"></i>ACKNOWLEDGE RESULTS
                    </button>
                </div>
            `;
        }

        function startPenTest() {
            const target = document.getElementById('targetInput').value;
            const terminal = document.getElementById('terminalOutput');
            
            terminal.innerHTML += `
                <div class="terminal-line">
                    <span class="terminal-prompt">IEBC-CSC></span> Starting penetration test on: ${target}
                </div>
                <div class="terminal-line text-yellow-400">
                    [INFO] Initializing vulnerability scanner...
                </div>
            `;
            
            setTimeout(() => {
                terminal.innerHTML += `
                    <div class="terminal-line text-green-400">
                        [SUCCESS] Port scan completed - 3 open ports found
                    </div>
                    <div class="terminal-line text-yellow-400">
                        [INFO] Testing for SQL injection vulnerabilities...
                    </div>
                `;
                
                setTimeout(() => {
                    terminal.innerHTML += `
                        <div class="terminal-line text-green-400">
                            [SUCCESS] No SQL injection vulnerabilities detected
                        </div>
                        <div class="terminal-line text-yellow-400">
                            [INFO] Testing for XSS vulnerabilities...
                        </div>
                    `;
                    
                    setTimeout(() => {
                        terminal.innerHTML += `
                            <div class="terminal-line text-red-400">
                                [CRITICAL] XSS vulnerability detected in login form
                            </div>
                            <div class="terminal-line text-yellow-400">
                                [INFO] Generating security report...
                            </div>
                            <div class="terminal-line text-green-400">
                                [COMPLETE] Penetration test finished - 1 critical issue found
                            </div>
                        `;
                        
                        terminal.scrollTop = terminal.scrollHeight;
                    }, 2000);
                }, 2000);
            }, 2000);
            
            terminal.scrollTop = terminal.scrollHeight;
        }

        function testBlockchainIntegrity() {
            const terminal = document.getElementById('terminalOutput');
            
            terminal.innerHTML += `
                <div class="terminal-line">
                    <span class="terminal-prompt">IEBC-CSC></span> Testing blockchain integrity...
                </div>
            `;
            
            setTimeout(() => {
                terminal.innerHTML += `
                    <div class="terminal-line text-green-400">
                        [SUCCESS] All blocks cryptographically verified
                    </div>
                    <div class="terminal-line text-green-400">
                        [SUCCESS] No tampering detected in voting records
                    </div>
                    <div class="terminal-line text-green-400">
                        [SUCCESS] Blockchain consensus: 47/47 nodes verified
                    </div>
                `;
                terminal.scrollTop = terminal.scrollHeight;
            }, 1500);
        }

        function showNetworkMonitor() {
            const modal = document.getElementById('securityModal');
            const content = document.getElementById('modalContent');
            const title = document.getElementById('modalTitle');
            
            title.textContent = 'NETWORK MONITORING DASHBOARD';
            content.innerHTML = `
                <div class="space-y-4">
                    <div class="grid grid-cols-3 gap-4">
                        <div class="cyber-card p-4 text-center">
                            <div class="text-2xl font-bold text-green-400">98.7%</div>
                            <div class="text-sm text-gray-400">Uptime</div>
                        </div>
                        <div class="cyber-card p-4 text-center">
                            <div class="text-2xl font-bold text-blue-400">2.3ms</div>
                            <div class="text-sm text-gray-400">Avg Latency</div>
                        </div>
                        <div class="cyber-card p-4 text-center">
                            <div class="text-2xl font-bold text-purple-400">47/47</div>
                            <div class="text-sm text-gray-400">Nodes Online</div>
                        </div>
                    </div>
                    
                    <div class="cyber-card p-4">
                        <h4 class="font-bold text-green-400 mb-2">Active Connections</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span>Voting Server 1</span>
                                <span class="text-green-400"> Active</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Database Cluster</span>
                                <span class="text-green-400"> Active</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Blockchain Node 12</span>
                                <span class="text-yellow-400"> High Load</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 text-center">
                    <button class="cyber-button" onclick="closeModal('securityModal')">
                        <i class="fas fa-times mr-2"></i>CLOSE
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function showDDoSProtection() {
            const modal = document.getElementById('securityModal');
            const content = document.getElementById('modalContent');
            const title = document.getElementById('modalTitle');
            
            title.textContent = 'DDoS PROTECTION DASHBOARD';
            content.innerHTML = `
                <div class="space-y-4">
                    <div class="grid grid-cols-3 gap-4">
                        <div class="cyber-card p-4 text-center">
                            <div class="text-2xl font-bold text-green-400">0</div>
                            <div class="text-sm text-gray-400">Current Attacks</div>
                        </div>
                        <div class="cyber-card p-4 text-center">
                            <div class="text-2xl font-bold text-blue-400">12.7K</div>
                            <div class="text-sm text-gray-400">Blocked Requests</div>
                        </div>
                        <div class="cyber-card p-4 text-center">
                            <div class="text-2xl font-bold text-yellow-400">98.3%</div>
                            <div class="text-sm text-gray-400">Success Rate</div>
                        </div>
                    </div>
                    
                    <div class="cyber-card p-4">
                        <h4 class="font-bold text-green-400 mb-2">Protection Status</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span>Rate Limiting</span>
                                <span class="text-green-400"> Active</span>
                            </div>
                            <div class="flex justify-between">
                                <span>IP Filtering</span>
                                <span class="text-green-400"> Active</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Traffic Analysis</span>
                                <span class="text-green-400"> Active</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Geolocation Blocking</span>
                                <span class="text-yellow-400"> Needs Update</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 text-center">
                    <button class="cyber-button" onclick="simulateDDoSAttack()">
                        <i class="fas fa-bolt mr-2"></i>TEST DDoS PROTECTION
                    </button>
                    <button class="cyber-button ml-2" onclick="closeModal('securityModal')">
                        <i class="fas fa-times mr-2"></i>CLOSE
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function showThreatAnalysis() {
            const modal = document.getElementById('securityModal');
            const content = document.getElementById('modalContent');
            const title = document.getElementById('modalTitle');
            
            title.textContent = 'THREAT ANALYSIS REPORT';
            content.innerHTML = `
                <div class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="cyber-card p-4 text-center">
                            <div class="text-2xl font-bold text-green-400">0</div>
                            <div class="text-sm text-gray-400">Active Threats</div>
                        </div>
                        <div class="cyber-card p-4 text-center">
                            <div class="text-2xl font-bold text-blue-400">47</div>
                            <div class="text-sm text-gray-400">Threats Blocked Today</div>
                        </div>
                    </div>
                    
                    <div class="cyber-card p-4">
                        <h4 class="font-bold text-green-400 mb-2">Recent Threat Activity</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span>SQL Injection Attempt</span>
                                <span class="text-red-400">14:23:05</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Brute Force Attack</span>
                                <span class="text-red-400">13:45:12</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Port Scanning</span>
                                <span class="text-yellow-400">12:30:45</span>
                            </div>
                            <div class="flex justify-between">
                                <span>XSS Attempt</span>
                                <span class="text-red-400">11:15:33</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="cyber-card p-4">
                        <h4 class="font-bold text-green-400 mb-2">Threat Intelligence</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span>Known Attack Patterns</span>
                                <span class="text-green-400">1,247</span>
                            </div>
                            <div class="flex justify-between">
                                <span>IP Blacklist Entries</span>
                                <span class="text-green-400">8,942</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Malware Signatures</span>
                                <span class="text-green-400">24,567</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 text-center">
                    <button class="cyber-button" onclick="closeModal('securityModal')">
                        <i class="fas fa-times mr-2"></i>CLOSE
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // Voting Functions
        function downloadVotingReceipt() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add IEBC logo
            doc.setFontSize(20);
            doc.setTextColor(0, 135, 81);
            doc.text('IEBC VOTING RECEIPT', 105, 20, { align: 'center' });
            
            // Add voter info
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('Voter ID: ' + document.getElementById('national-id').value, 20, 40);
            doc.text('Timestamp: ' + document.getElementById('receiptTimestamp').textContent, 20, 50);
            doc.text('Transaction ID: ' + document.getElementById('receiptTransactionId').textContent, 20, 60);
            
            // Add line
            doc.setDrawColor(0, 135, 81);
            doc.setLineWidth(0.5);
            doc.line(20, 65, 190, 65);
            
            // Add vote summary
            doc.setFontSize(14);
            doc.setTextColor(0, 135, 81);
            doc.text('YOUR VOTE SUMMARY', 105, 75, { align: 'center' });
            
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            doc.text('President: James Mwangi - Unity Party', 20, 85);
            doc.text('Governor: Johnson Sakaja - UDA', 20, 95);
            doc.text('Senator: Edwin Sifuna - ODM', 20, 105);
            
            // Add watermark
            doc.setFontSize(60);
            doc.setTextColor(200, 200, 200);
            doc.text('VALID', 105, 140, { align: 'center', angle: 45 });
            
            // Save the PDF
            doc.save('IEBC_Voting_Receipt.pdf');
        }

        // Terminal functionality
        function handleTerminalInput(event) {
            if (event.key === 'Enter') {
                const input = document.getElementById('terminalInput');
                const command = input.value.trim();
                input.value = '';
                
                if (command) {
                    processCommand(command);
                }
            }
        }

        function processCommand(command) {
            const terminal = document.getElementById('terminalOutput');
            const prompt = '<span class="terminal-prompt">IEBC-CSC></span>';
            
            terminal.innerHTML += `<div class="terminal-line">${prompt} ${command}</div>`;
            
            const lowerCommand = command.toLowerCase();
            
            if (lowerCommand === 'help') {
                terminal.innerHTML += `<div class="terminal-line">
                    Available commands:<br>
                    - scan [target] : Run security scan<br>
                    - test [system] : Test system integrity<br>
                    - status : Show system status<br>
                    - clear : Clear terminal<br>
                    - help : Show this help
                </div>`;
            } else if (lowerCommand === 'status') {
                terminal.innerHTML += `<div class="terminal-line">
                    System Status:<br>
                    - Voting Security: ACTIVE<br>
                    - Blockchain: VERIFIED<br>
                    - Penetration Suite: READY<br>
                    - Threats Detected: 0<br>
                    - Last Audit: ${new Date().toLocaleString()}
                </div>`;
            } else if (lowerCommand.startsWith('scan ')) {
                const target = command.substring(5);
                terminal.innerHTML += `<div class="terminal-line">Initiating security scan on: ${target}</div>`;
                simulateSecurityScan(target);
            } else if (lowerCommand === 'clear') {
                terminal.innerHTML = '';
            } else {
                terminal.innerHTML += `<div class="terminal-line">Unknown command: ${command}. Type 'help' for available commands.</div>`;
            }
            
            terminal.scrollTop = terminal.scrollHeight;
        }

        function clearTerminal() {
            document.getElementById('terminalOutput').innerHTML = '';
        }

        function exportLogs() {
            const terminal = document.getElementById('terminalOutput');
            const logs = terminal.innerText;
            const blob = new Blob([logs], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `iebc-security-logs-${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
        }

        function emergencyStop() {
            const terminal = document.getElementById('terminalOutput');
            
            terminal.innerHTML += `
                <div class="terminal-line text-red-400">
                    [EMERGENCY] All penetration tests stopped immediately!
                </div>
                <div class="terminal-line text-red-400">
                    [EMERGENCY] Security protocols reinforced!
                </div>
                <div class="terminal-line text-green-400">
                    [SUCCESS] All systems secured and locked down
                </div>
            `;
            terminal.scrollTop = terminal.scrollHeight;
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        function updateTime() {
            document.getElementById('currentTime').textContent = new Date().toLocaleString();
        }

        function initNetworkVisualization() {
            const network = document.getElementById('networkVisualization');
            const nodes = [
                { id: 'voting-server', name: 'Voting Server', x: '20%', y: '50%' },
                { id: 'blockchain-node', name: 'Blockchain', x: '40%', y: '30%' },
                { id: 'auth-server', name: 'Authentication', x: '40%', y: '70%' },
                { id: 'database', name: 'Database', x: '60%', y: '50%' },
                { id: 'monitoring', name: 'Monitoring', x: '80%', y: '50%' }
            ];
            
            nodes.forEach(node => {
                const nodeEl = document.createElement('div');
                nodeEl.className = 'network-node';
                nodeEl.style.left = node.x;
                nodeEl.style.top = node.y;
                nodeEl.innerHTML = `<div class="text-center"><i class="fas fa-server mb-1"></i><div class="text-xs">${node.name}</div></div>`;
                network.appendChild(nodeEl);
            });
        }

        function simulateSecurityScan(target) {
            const vulnerabilities = [
                { type: 'XSS', severity: 'high', description: 'Cross-site scripting vulnerability in login form' },
                { type: 'SQLi', severity: 'critical', description: 'SQL injection possible in user input' },
                { type: 'CSRF', severity: 'medium', description: 'Cross-site request forgery protection needed' }
            ];
            
            setTimeout(() => {
                logToTerminal('Security scan completed');
                vulnerabilities.forEach(vuln => {
                    logToTerminal(`[${vuln.severity.toUpperCase()}] ${vuln.type}: ${vuln.description}`);
                });
            }, 2000);
        }

        function logToTerminal(message) {
            const terminal = document.getElementById('terminalOutput');
            terminal.innerHTML += `<div class="terminal-line">${message}</div>`;
            terminal.scrollTop = terminal.scrollHeight;
        }

        // Additional helper functions
        function simulateVotingAttack() {
            alert('Simulating voting attack... This would test system resilience in a real implementation.');
        }

        function generateSecurityReport() {
            alert('Generating security report... This would create a comprehensive security assessment in a real implementation.');
        }
    </script>
</body>
</html>